<HTML> <BODY BGCOLOR=#eeeeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>! -----------------------------------------------------------<a name='2'></font>
<A NAME='IFIJN'><A href='../../html_code/CGEM_2.0/iFijn.f.html#IFIJN' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='3'>
      <font color=#993300>function </font><font color=#cc0000>iFijn</font> (X,N,XI)    RESULT(iiFijn) <A href='../../call_to/IFIJN.html' TARGET='index'>2</A><a name='4'>
<font color=#447700>!         Written  by ::  D.S.Ko<a name='5'></font>
<font color=#447700>!         Modified by ::  Barry Herchenroder/EMVL, April 2010<a name='6'></font>
<font color=#447700>!                                                  May   2011<a name='7'></font>
<font color=#447700>! ------------------------------------------------------------<a name='8'></font>
<font color=#447700>!     Purpose of this function: Find nearest grid point<a name='9'></font>
<font color=#447700>! ------------------------------------------------------------<a name='10'></font>
<a name='11'>
<font color=#447700>!------------------<a name='12'></font>
<font color=#447700>!  Input and Output<a name='13'></font>
<font color=#447700>!------------------ <a name='14'></font>
      INTEGER, INTENT(IN) :: N<a name='15'>
      <a name='16'>
      real   , INTENT(IN) :: X(*)<a name='17'>
      real   , INTENT(IN) :: XI     <a name='18'>
      <a name='19'>
<font color=#447700>!----------------      <a name='20'></font>
<font color=#447700>! Other variables      <a name='21'></font>
<font color=#447700>!----------------<a name='22'></font>
      INTEGER  :: i<a name='23'>
      INTEGER  :: iiFijn      <a name='24'>
<a name='25'>
<font color=#447700>!------------------------------------------------<a name='26'></font>
 <a name='27'>
      if (XI.le.X(1)) then<a name='28'>
        iiFijn = 1<a name='29'>
      else if (XI.ge.X(N)) then<a name='30'>
        iiFijn = N<a name='31'>
      else<a name='32'>
        do i = 1, N-1<a name='33'>
          if (XI.ge.X(i).and.XI.lt.X(i+1)) goto 8<a name='34'>
        end do<a name='35'>
8       iiFijn = i+nint((XI-X(i))/(X(i+1)-X(i)))<a name='36'>
      end if<a name='37'>
<a name='38'>
      return<a name='39'>
      end FUNCTION iFijn<a name='40'>
</pre></body></html>
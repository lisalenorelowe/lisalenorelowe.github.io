<HTML> <BODY BGCOLOR=#eeeeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!******************************************************************************<a name='2'></font>
<font color=#447700>! PURPOSE: OUTPUT_NETCDF.F90 - Routines for outputting NCOM_GEM data to a<a name='3'></font>
<font color=#447700>!          NetCDF file.<a name='4'></font>
<font color=#447700>! NOTES:   Non-ADT module.<a name='5'></font>
<font color=#447700>! HISTORY: 2010/04/26, Todd Plessel, plessel.todd@epa.gov, Created.<a name='6'></font>
<font color=#447700>!******************************************************************************<a name='7'></font>
<a name='8'>
<A NAME='OUTPUT_NETCDF'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='9'>
<font color=#993300>MODULE </font><font color=#cc0000>OUTPUT_NETCDF</font> <A href='../../call_to/OUTPUT_NETCDF.html' TARGET='index'>4</A>,<A href='../../call_from/OUTPUT_NETCDF.html' TARGET='index'>8</A><a name='10'>
<a name='11'>
  USE pnetcdf <font color=#447700>! For NFMPI_*<a name='12'></font>
  USE <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#NETCDF_UTILITIES'>NETCDF_UTILITIES</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_UTILITIES_2"> <font color=#447700>! For CHKERR, DEFDIM, DEFVI1, CONVERT_LONGITUDES, etc.<a name='13'></font>
  USE <A href='../../html_code/CGEM_2.0/DATE_TIME.f.html#DATE_TIME'>DATE_TIME</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DATE_TIME_16"> <font color=#447700>! For TOTAL_SECONDS<a name='14'></font>
<a name='15'>
  USE <A href='../../html_code/CGEM_2.0/Model_dim.f.html#MODEL_DIM'>Model_dim</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODEL_DIM_45">, ONLY: nf<a name='16'>
  USE <A href='../../html_code/CGEM_2.0/INPUT_VARS.f.html#INPUT_VARS'>INPUT_VARS</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INPUT_VARS_29"><a name='17'>
  USE <A href='../../html_code/CGEM_2.0/CGEM_vars.f.html#CGEM_VARS'>CGEM_vars</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CGEM_VARS_12"><a name='18'>
  USE <A href='../../html_code/CGEM_2.0/LIGHT_VARS.f.html#LIGHT_VARS'>LIGHT_VARS</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LIGHT_VARS_2"><a name='19'>
  USE <A href='../../html_code/CGEM_2.0/Which_Flux.f.html#WHICH_FLUX'>Which_Flux</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WHICH_FLUX_4"><a name='20'>
  USE <A href='../../html_code/CGEM_2.0/TEMP_VARS.f.html#TEMP_VARS'>TEMP_VARS</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TEMP_VARS_2"><a name='21'>
<a name='22'>
  IMPLICIT NONE<a name='23'>
  INCLUDE '<A href='../../html_code/include/mpif.h.html'>mpif.h</A>' <A NAME="mpif.h_1"><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_NETCDF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><font color=#447700>! For MPI_*<a name='24'></font>
<a name='25'>
  <font color=#447700>! Private<a name='26'></font>
<a name='27'>
  INTEGER,PARAMETER:: VARIABLES = nf<a name='28'>
  CHARACTER(LEN=*),PARAMETER,DIMENSION(VARIABLES):: VARIABLE_NAMES = (/ &amp;<a name='29'>
    'A1    ', &amp;<a name='30'>
    'A2    ', &amp;<a name='31'>
    'A3    ', &amp;<a name='32'>
    'A4    ', &amp;<a name='33'>
    'A5    ', &amp;<a name='34'>
    'A6    ', &amp;<a name='35'>
    'Qn1   ', &amp;<a name='36'>
    'Qn2   ', &amp;<a name='37'>
    'Qn3   ', &amp;<a name='38'>
    'Qn4   ', &amp;<a name='39'>
    'Qn5   ', &amp;<a name='40'>
    'Qn6   ', &amp;<a name='41'>
    'Qp1   ', &amp;<a name='42'>
    'Qp2   ', &amp;<a name='43'>
    'Qp3   ', &amp;<a name='44'>
    'Qp4   ', &amp;<a name='45'>
    'Qp5   ', &amp;<a name='46'>
    'Qp6   ', &amp;<a name='47'>
    'Z1    ', &amp;<a name='48'>
    'Z2    ', &amp;<a name='49'>
    'NO3   ', &amp;<a name='50'>
    'NH4   ', &amp;<a name='51'>
    'PO4   ', &amp;<a name='52'>
    'DIC   ', &amp;<a name='53'>
    'O2    ', &amp;<a name='54'>
    'OM1_A ', &amp;<a name='55'>
    'OM2_A ', &amp;<a name='56'>
    'OM1_Z', &amp;<a name='57'>
    'OM2_Z', &amp;<a name='58'>
    'OM1_R', &amp;<a name='59'>
    'OM2_R', &amp;<a name='60'>
    'CDOM  ', &amp;<a name='61'>
    'Si    ', &amp;<a name='62'>
    'OM1_BC', &amp;<a name='63'>
    'OM2_BC', &amp;<a name='64'>
    'ALK   '  &amp;<a name='65'>
  /)<a name='66'>
  LOGICAL,PARAMETER,DIMENSION(VARIABLES):: WRITE_VARIABLE = (/ &amp;<a name='67'>
    .TRUE. , &amp;<a name='68'>
    .TRUE. , &amp;<a name='69'>
    .TRUE. , &amp;<a name='70'>
    .TRUE. , &amp;<a name='71'>
    .TRUE. , &amp;<a name='72'>
    .TRUE. , &amp;<a name='73'>
    .TRUE. , &amp;<a name='74'>
    .TRUE. , &amp;<a name='75'>
    .TRUE. , &amp;<a name='76'>
    .TRUE. , &amp;<a name='77'>
    .TRUE. , &amp;<a name='78'>
    .TRUE. , &amp;<a name='79'>
    .TRUE. , &amp;<a name='80'>
    .TRUE. , &amp;<a name='81'>
    .TRUE. , &amp;<a name='82'>
    .TRUE. , &amp;<a name='83'>
    .TRUE. , &amp;<a name='84'>
    .TRUE. , &amp;<a name='85'>
    .TRUE. , &amp;<a name='86'>
    .TRUE. , &amp;<a name='87'>
    .TRUE. , &amp;<a name='88'>
    .TRUE. , &amp;<a name='89'>
    .TRUE. , &amp;<a name='90'>
    .TRUE. , &amp;<a name='91'>
    .TRUE. , &amp;<a name='92'>
    .TRUE. , &amp;<a name='93'>
    .TRUE. , &amp;<a name='94'>
    .TRUE. , &amp;<a name='95'>
    .TRUE. , &amp;<a name='96'>
    .TRUE. , &amp;<a name='97'>
    .TRUE. , &amp;<a name='98'>
    .TRUE. , &amp;<a name='99'>
    .TRUE. , &amp;<a name='100'>
    .TRUE. , &amp;<a name='101'>
    .TRUE. , &amp;<a name='102'>
    .TRUE.   &amp;<a name='103'>
  /)<a name='104'>
  CHARACTER(LEN=*),PARAMETER,DIMENSION(VARIABLES):: VARIABLE_DESCRIPTIONS = (/&amp;<a name='105'>
    'Phytoplantkton group 1 number density.                              ', &amp;<a name='106'>
    'Phytoplantkton group 2 number density.                              ', &amp;<a name='107'>
    'Phytoplantkton group 3 number density.                              ', &amp;<a name='108'>
    'Phytoplantkton group 4 number density.                              ', &amp;<a name='109'>
    'Phytoplantkton group 5 number density.                              ', &amp;<a name='110'>
    'Phytoplantkton group 6 number density.                              ', &amp;<a name='111'>
    'Phytoplantkton group 1 nitrogen quota.                              ', &amp;<a name='112'>
    'Phytoplantkton group 2 nitrogen quota.                              ', &amp;<a name='113'>
    'Phytoplantkton group 3 nitrogen quota.                              ', &amp;<a name='114'>
    'Phytoplantkton group 4 nitrogen quota.                              ', &amp;<a name='115'>
    'Phytoplantkton group 5 nitrogen quota.                              ', &amp;<a name='116'>
    'Phytoplantkton group 6 nitrogen quota.                              ', &amp;<a name='117'>
    'Phytoplantkton group 1 phosphorus quota.                            ', &amp;<a name='118'>
    'Phytoplantkton group 2 phosphorus quota.                            ', &amp;<a name='119'>
    'Phytoplantkton group 3 phosphorus quota.                            ', &amp;<a name='120'>
    'Phytoplantkton group 4 phosphorus quota.                            ', &amp;<a name='121'>
    'Phytoplantkton group 5 phosphorus quota.                            ', &amp;<a name='122'>
    'Phytoplantkton group 6 phosphorus quota.                            ', &amp;<a name='123'>
    'Zooplantkton group 1 number density.                                ', &amp;<a name='124'>
    'Zooplantkton group 2 number density.                                ', &amp;<a name='125'>
    'Nitrate.                                                            ', &amp;<a name='126'>
    'Ammonium.                                                           ', &amp;<a name='127'>
    'Phosphate.                                                          ', &amp;<a name='128'>
    'Dissolved inorganic carbon.                                         ', &amp;<a name='129'>
    'Molecular oxygen.                                                   ', &amp;<a name='130'>
    'Particulate organic matter derived from dead algae.                 ', &amp;<a name='131'>
    'Dissolved organic matter derived from dead algae.                   ', &amp;<a name='132'>
    'Particulate organic matter derived from zooplankton fecal pellets.  ', &amp;<a name='133'>
    'Dissolved organic matter derived from zooplankton fecal pellets.    ', &amp;<a name='134'>
    'Particulate organic matter derived from river outflow.              ', &amp;<a name='135'>
    'Dissolved organic matter derived from river outflow.                ', &amp;<a name='136'>
    'Colored dissolved organic matter.                                   ', &amp;<a name='137'>
    'Silica.                                                             ', &amp;<a name='138'>
    'Fast reacting organic matter in the initial and boundary conditions ', &amp;<a name='139'>
    'Slow reacting organic matter in the initial and boundary conditions ', &amp;<a name='140'>
    'Alkalinity.                                                         '  &amp;<a name='141'>
  /)<a name='142'>
  CHARACTER(LEN=*),PARAMETER,DIMENSION(VARIABLES):: VARIABLE_UNITS = (/ &amp;<a name='143'>
    'cells/m3                        ', &amp;<a name='144'>
    'cells/m3                        ', &amp;<a name='145'>
    'cells/m3                        ', &amp;<a name='146'>
    'cells/m3                        ', &amp;<a name='147'>
    'cells/m3                        ', &amp;<a name='148'>
    'cells/m3                        ', &amp;<a name='149'>
    'mmol-N/cell                     ', &amp;<a name='150'>
    'mmol-N/cell                     ', &amp;<a name='151'>
    'mmol-N/cell                     ', &amp;<a name='152'>
    'mmol-N/cell                     ', &amp;<a name='153'>
    'mmol-N/cell                     ', &amp;<a name='154'>
    'mmol-N/cell                     ', &amp;<a name='155'>
    'mmol-P/cell                     ', &amp;<a name='156'>
    'mmol-P/cell                     ', &amp;<a name='157'>
    'mmol-P/cell                     ', &amp;<a name='158'>
    'mmol-P/cell                     ', &amp;<a name='159'>
    'mmol-P/cell                     ', &amp;<a name='160'>
    'mmol-P/cell                     ', &amp;<a name='161'>
    'organisms/m3                    ', &amp;<a name='162'>
    'organisms/m3                    ', &amp;<a name='163'>
    'mmol-N/m3                       ', &amp;<a name='164'>
    'mmol-N/m3                       ', &amp;<a name='165'>
    'mmol-P/m3                       ', &amp;<a name='166'>
    'mmol-C/m3                       ', &amp;<a name='167'>
    'mmol-O2/m3                      ', &amp;<a name='168'>
    'mmol-C/m3                       ', &amp;<a name='169'>
    'mmol-C/m3                       ', &amp;<a name='170'>
    'mmol-C/m3                       ', &amp;<a name='171'>
    'mmol-C/m3                       ', &amp;<a name='172'>
    'mmol-C/m3                       ', &amp;<a name='173'>
    'mmol-C/m3                       ', &amp;<a name='174'>
    'ppb                             ', &amp;<a name='175'>
    'mmol-Si/m3                      ', &amp;<a name='176'>
    'mmol-C/m3                       ', &amp;<a name='177'>
    'mmol-C/m3                       ', &amp;<a name='178'>
    'mmol/m3                         '  &amp;<a name='179'>
  /)<a name='180'>
  INTEGER,PARAMETER:: EXTRA_VARIABLES = 49 <a name='181'>
  CHARACTER(LEN=*),PARAMETER,DIMENSION(EXTRA_VARIABLES):: &amp;<a name='182'>
    EXTRA_VARIABLE_NAMES = (/ &amp;<a name='183'>
    'irradiance                      ', &amp;<a name='184'>
    'irradiance_fraction             ', &amp;<a name='185'>
    'uN1                             ', &amp;<a name='186'>
    'uN2                             ', &amp;<a name='187'>
    'uN3                             ', &amp;<a name='188'>
    'uN4                             ', &amp;<a name='189'>
    'uN5                             ', &amp;<a name='190'>
    'uN6                             ', &amp;<a name='191'>
    'uP1                             ', &amp;<a name='192'>
    'uP2                             ', &amp;<a name='193'>
    'uP3                             ', &amp;<a name='194'>
    'uP4                             ', &amp;<a name='195'>
    'uP5                             ', &amp;<a name='196'>
    'uP6                             ', &amp;<a name='197'>
    'uE1                             ', &amp;<a name='198'>
    'uE2                             ', &amp;<a name='199'>
    'uE3                             ', &amp;<a name='200'>
    'uE4                             ', &amp;<a name='201'>
    'uE5                             ', &amp;<a name='202'>
    'uE6                             ', &amp;<a name='203'>
    'uA1                             ', &amp;<a name='204'>
    'uA2                             ', &amp;<a name='205'>
    'uA3                             ', &amp;<a name='206'>
    'uA4                             ', &amp;<a name='207'>
    'uA5                             ', &amp;<a name='208'>
    'uA6                             ', &amp;<a name='209'>
    'Chla_mg_tot                     ', &amp;<a name='210'>
    's_x1A                           ', &amp;<a name='211'>
    's_y1A                           ', &amp;<a name='212'>
    's_x2A                           ', &amp;<a name='213'>
    's_y2A                           ', &amp;<a name='214'>
    's_x1Z                           ', &amp;<a name='215'>
    's_x2Z                           ', &amp;<a name='216'>
    's_y1Z                           ', &amp;<a name='217'>
    's_y2Z                           ', &amp;<a name='218'>
    'uSi1                            ', &amp;<a name='219'>
    'uSi2                            ', &amp;<a name='220'>
    'uSi3                            ', &amp;<a name='221'>
    'uSi4                            ', &amp;<a name='222'>
    'uSi5                            ', &amp;<a name='223'>
    'uSi6                            ', &amp;<a name='224'>
    'Chl_C1                          ', &amp;<a name='225'>
    'Chl_C2                          ', &amp;<a name='226'>
    'Chl_C3                          ', &amp;<a name='227'>
    'Chl_C4                          ', &amp;<a name='228'>
    'Chl_C5                          ', &amp;<a name='229'>
    'Chl_C6                          ', &amp;<a name='230'>
    'pH                              ', &amp;<a name='231'>
    'RN2                             ' &amp;<a name='232'>
  /)<a name='233'>
  LOGICAL,PARAMETER,DIMENSION(EXTRA_VARIABLES):: WRITE_EXTRA_VARIABLE = (/ &amp;<a name='234'>
    .TRUE. , &amp;<a name='235'>
    .TRUE. , &amp;<a name='236'>
    .TRUE. , &amp;<a name='237'>
    .TRUE. , &amp;<a name='238'>
    .TRUE. , &amp;<a name='239'>
    .TRUE. , &amp;<a name='240'>
    .TRUE. , &amp;<a name='241'>
    .TRUE. , &amp;<a name='242'>
    .TRUE. , &amp;<a name='243'>
    .TRUE. , &amp;<a name='244'>
    .TRUE. , &amp;<a name='245'>
    .TRUE. , &amp;<a name='246'>
    .TRUE. , &amp;<a name='247'>
    .TRUE. , &amp;<a name='248'>
    .TRUE. , &amp;<a name='249'>
    .TRUE. , &amp;<a name='250'>
    .TRUE. , &amp;<a name='251'>
    .TRUE. , &amp;<a name='252'>
    .TRUE. , &amp;<a name='253'>
    .TRUE. , &amp;<a name='254'>
    .TRUE. , &amp;<a name='255'>
    .TRUE. , &amp;<a name='256'>
    .TRUE. , &amp;<a name='257'>
    .TRUE. , &amp;<a name='258'>
    .TRUE. , &amp;<a name='259'>
    .TRUE. , &amp;<a name='260'>
    .TRUE. , &amp;<a name='261'>
    .TRUE. , &amp;<a name='262'>
    .TRUE. , &amp;<a name='263'>
    .TRUE. , &amp;<a name='264'>
    .TRUE. , &amp;<a name='265'>
    .TRUE. , &amp;<a name='266'>
    .TRUE. , &amp;<a name='267'>
    .TRUE. , &amp;<a name='268'>
    .TRUE. , &amp;<a name='269'>
    .TRUE. , &amp;<a name='270'>
    .TRUE. , &amp;<a name='271'>
    .TRUE. , &amp;<a name='272'>
    .TRUE. , &amp;<a name='273'>
    .TRUE. , &amp;<a name='274'>
    .TRUE. , &amp;<a name='275'>
    .TRUE. , &amp;<a name='276'>
    .TRUE. , &amp;<a name='277'>
    .TRUE. , &amp;<a name='278'>
    .TRUE. , &amp;<a name='279'>
    .TRUE. , &amp;<a name='280'>
    .TRUE. , &amp;<a name='281'>
    .TRUE. , &amp;<a name='282'>
    .TRUE.   &amp;<a name='283'>
  /)<a name='284'>
  CHARACTER(LEN=*),PARAMETER,DIMENSION(EXTRA_VARIABLES):: &amp;<a name='285'>
    EXTRA_VARIABLE_DESCRIPTIONS = (/ &amp;<a name='286'>
    'Irradiance at depth.                                                ', &amp;<a name='287'>
    'Fraction of surface irradiance                                      ', &amp;<a name='288'>
    'nitrogen-dependent growth rate for A1                               ', &amp;<a name='289'>
    'nitrogen-dependent growth rate for A2                               ', &amp;<a name='290'>
    'nitrogen-dependent growth rate for A3                               ', &amp;<a name='291'>
    'nitrogen-dependent growth rate for A4                               ', &amp;<a name='292'>
    'nitrogen-dependent growth rate for A5                               ', &amp;<a name='293'>
    'nitrogen-dependent growth rate for A6                               ', &amp;<a name='294'>
    'phosphorus-dependent growth rate for A1                             ', &amp;<a name='295'>
    'phosphorus-dependent growth rate for A2                             ', &amp;<a name='296'>
    'phosphorus-dependent growth rate for A3                             ', &amp;<a name='297'>
    'phosphorus-dependent growth rate for A4                             ', &amp;<a name='298'>
    'phosphorus-dependent growth rate for A5                             ', &amp;<a name='299'>
    'phosphorus-dependent growth rate for A6                             ', &amp;<a name='300'>
    'light-dependent growth rate for A1                                  ', &amp;<a name='301'>
    'light-dependent growth rate for A2                                  ', &amp;<a name='302'>
    'light-dependent growth rate for A3                                  ', &amp;<a name='303'>
    'light-dependent growth rate for A4                                  ', &amp;<a name='304'>
    'light-dependent growth rate for A5                                  ', &amp;<a name='305'>
    'light-dependent growth rate for A6                                  ', &amp;<a name='306'>
    'specific growth rate for A1                                         ', &amp;<a name='307'>
    'specific growth rate for A2                                         ', &amp;<a name='308'>
    'specific growth rate for A3                                         ', &amp;<a name='309'>
    'specific growth rate for A4                                         ', &amp;<a name='310'>
    'specific growth rate for A5                                         ', &amp;<a name='311'>
    'specific growth rate for A6                                         ', &amp;<a name='312'>
    'Total Chla from all phytoplankton                                   ', &amp;<a name='313'>
    'Stoichiometry C:P for OM1_A                                         ', &amp;<a name='314'>
    'Stoichiometry N:P for OM1_A                                         ', &amp;<a name='315'>
    'Stoichiometry C:P for OM2_A                                         ', &amp;<a name='316'>
    'Stoichiometry N:P for OM2_A                                         ', &amp;<a name='317'>
    'Stoichiometry C:P for OM1_Z                                         ', &amp;<a name='318'>
    'Stoichiometry N:P for OM1_Z                                         ', &amp;<a name='319'>
    'Stoichiometry C:P for OM2_Z                                         ', &amp;<a name='320'>
    'Stoichiometry N:P for OM2_Z                                         ', &amp;<a name='321'>
    'silica-dependent growth rate for A1                                 ', &amp;<a name='322'>
    'silica-dependent growth rate for A2                                 ', &amp;<a name='323'>
    'silica-dependent growth rate for A3                                 ', &amp;<a name='324'>
    'silica-dependent growth rate for A4                                 ', &amp;<a name='325'>
    'silica-dependent growth rate for A5                                 ', &amp;<a name='326'>
    'silica-dependent growth rate for A6                                 ', &amp;<a name='327'>
    'Chl:C for A1                                                        ', &amp;<a name='328'>
    'Chl:C for A2                                                        ', &amp;<a name='329'>
    'Chl:C for A3                                                        ', &amp;<a name='330'>
    'Chl:C for A4                                                        ', &amp;<a name='331'>
    'Chl:C for A5                                                        ', &amp;<a name='332'>
    'Chl:C for A6                                                        ', &amp;<a name='333'>
    'pH                                                                  ', &amp;<a name='334'>
    'RN2 sum of N from N2 in reaction equations                          '  &amp;<a name='335'>
  /)<a name='336'>
  CHARACTER(LEN=*),PARAMETER,DIMENSION(EXTRA_VARIABLES):: &amp;<a name='337'>
    EXTRA_VARIABLE_UNITS = (/ &amp;<a name='338'>
    'photons/cm2/s                   ', &amp;<a name='339'>
    '%                               ', &amp;<a name='340'>
    'd-1                             ', &amp;<a name='341'>
    'd-1                             ', &amp;<a name='342'>
    'd-1                             ', &amp;<a name='343'>
    'd-1                             ', &amp;<a name='344'>
    'd-1                             ', &amp;<a name='345'>
    'd-1                             ', &amp;<a name='346'>
    'd-1                             ', &amp;<a name='347'>
    'd-1                             ', &amp;<a name='348'>
    'd-1                             ', &amp;<a name='349'>
    'd-1                             ', &amp;<a name='350'>
    'd-1                             ', &amp;<a name='351'>
    'd-1                             ', &amp;<a name='352'>
    'd-1                             ', &amp;<a name='353'>
    'd-1                             ', &amp;<a name='354'>
    'd-1                             ', &amp;<a name='355'>
    'd-1                             ', &amp;<a name='356'>
    'd-1                             ', &amp;<a name='357'>
    'd-1                             ', &amp;<a name='358'>
    'd-1                             ', &amp;<a name='359'>
    'd-1                             ', &amp;<a name='360'>
    'd-1                             ', &amp;<a name='361'>
    'd-1                             ', &amp;<a name='362'>
    'd-1                             ', &amp;<a name='363'>
    'd-1                             ', &amp;<a name='364'>
    'mg-Chla/m3                      ', &amp;<a name='365'>
    'C:P (mmol/mmol)                 ', &amp;<a name='366'>
    'N:P (mmol/mmol)                 ', &amp;<a name='367'>
    'C:P (mmol/mmol)                 ', &amp;<a name='368'>
    'N:P (mmol/mmol)                 ', &amp;<a name='369'>
    'C:P (mmol/mmol)                 ', &amp;<a name='370'>
    'N:P (mmol/mmol)                 ', &amp;<a name='371'>
    'C:P (mmol/mmol)                 ', &amp;<a name='372'>
    'N:P (mmol/mmol)                 ', &amp;<a name='373'>
    'd-1                             ', &amp;<a name='374'>
    'd-1                             ', &amp;<a name='375'>
    'd-1                             ', &amp;<a name='376'>
    'd-1                             ', &amp;<a name='377'>
    'd-1                             ', &amp;<a name='378'>
    'd-1                             ', &amp;<a name='379'>
    'mg-Chla/mg-C                    ', &amp;<a name='380'>
    'mg-Chla/mg-C                    ', &amp;<a name='381'>
    'mg-Chla/mg-C                    ', &amp;<a name='382'>
    'mg-Chla/mg-C                    ', &amp;<a name='383'>
    'mg-Chla/mg-C                    ', &amp;<a name='384'>
    'mg-Chla/mg-C                    ', &amp;<a name='385'>
    's.u.                            ', &amp;<a name='386'>
    'mmol-N/m3                       '  &amp;<a name='387'>
  /)<a name='388'>
  INTEGER,DIMENSION(EXTRA_VARIABLES):: EXTRA_VAR <font color=#447700>! NetCDF IDs for extra vars.<a name='389'></font>
  INTEGER,DIMENSION(VARIABLES):: F_VAR <font color=#447700>! NetCDF IDs for each variable.<a name='390'></font>
  INTEGER TIME_VAR <font color=#447700>! NetCDF ID for time array variable.<a name='391'></font>
  INTEGER FILE_ID <font color=#447700>! NetCDF ID for file.<a name='392'></font>
  INTEGER FILE_FIRST_TIMESTEP <font color=#447700>! 0-based model timestep number of current file.<a name='393'></font>
  INTEGER SECONDS_PER_TIMESTEP <font color=#447700>! Output timestep size in seconds.<a name='394'></font>
  INTEGER(8) SECONDS0 <font color=#447700>! Seconds since Model_dim::iYr0.<a name='395'></font>
<a name='396'>
PUBLIC OUTPUT_VARIABLE_COUNT, WRITE_VARIABLE, CREATE_FILE, OPEN_FILE, &amp;<a name='397'>
       WRITE_SUBSET_DATA, CLOSE_FILE, FLUSH_FILE, &amp;<a name='398'>
       WRITE_EXTRA_VARIABLE, WRITE_EXTRA_DATA, READ_EXTRA_DATA, READ_DATA, &amp;<a name='399'>
       LAST_NETCDF_TIMESTEP<a name='400'>
<a name='401'>
PRIVATE<a name='402'>
CONTAINS<a name='403'>
<a name='404'>
  <font color=#447700>! Public<a name='405'></font>
<a name='406'>
  <font color=#447700>! Commands:<a name='407'></font>
<a name='408'>
  <font color=#447700>! Return number of variables to be written:<a name='409'></font>
<a name='410'>
<A NAME='OUTPUT_VARIABLE_COUNT'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OUTPUT_VARIABLE_COUNT' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='411'>
  <font color=#993300>FUNCTION </font><font color=#cc0000>OUTPUT_VARIABLE_COUNT</font>() RESULT( RES )<a name='412'>
    IMPLICIT NONE<a name='413'>
    INTEGER RES<a name='414'>
    INTEGER VARIABLE<a name='415'>
<a name='416'>
    RES = 0<a name='417'>
<a name='418'>
    DO VARIABLE = 1, VARIABLES<a name='419'>
<a name='420'>
      IF ( WRITE_VARIABLE( VARIABLE ) ) THEN<a name='421'>
        RES = RES + 1<a name='422'>
      END IF<a name='423'>
    END DO<a name='424'>
<a name='425'>
    RETURN<a name='426'>
  END FUNCTION OUTPUT_VARIABLE_COUNT<a name='427'>
<a name='428'>
<a name='429'>
<a name='430'>
  <font color=#447700>! CREATE_FILE: Create output NetCDF file with given header data.<a name='431'></font>
  <font color=#447700>! In a concurrent program, only one process should call this routine<a name='432'></font>
  <font color=#447700>! then call CLOSE_FILE then<a name='433'></font>
  <font color=#447700>! worker processes should call OPEN_FILE, WRITE_SUBSET_DATA, CLOSE_FILE.<a name='434'></font>
  <font color=#447700>!<a name='435'></font>
<A NAME='CREATE_FILE'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='436'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>CREATE_FILE</font>( NAME, IM, JM, NSL, NSTEP, &amp; <A href='../../call_to/CREATE_FILE.html' TARGET='index'>4</A>,<A href='../../call_from/CREATE_FILE.html' TARGET='index'>192</A><a name='437'>
                          IYR0, &amp;<a name='438'>
                          IYRS, IMONS, IDAYS, IHRS, IMINS, ISECS, &amp;<a name='439'>
                          IYRE, IMONE, IDAYE, IHRE, IMINE, ISECE, &amp;<a name='440'>
                          DT_OUT, RLON, RLAT, H, FM, ZL, ZZ, DZ)<a name='441'>
    IMPLICIT NONE<a name='442'>
    CHARACTER(LEN=*),INTENT(IN):: NAME<a name='443'>
    INTEGER,INTENT(IN):: IM, JM, NSL<a name='444'>
    INTEGER,INTENT(IN):: NSTEP<a name='445'>
    INTEGER,INTENT(IN):: IYR0 <font color=#447700>! Reference year (before start of model run).<a name='446'></font>
    INTEGER,INTENT(IN):: IYRS, IMONS, IDAYS, IHRS, IMINS, ISECS <font color=#447700>! Run start.<a name='447'></font>
    INTEGER,INTENT(IN):: IYRE, IMONE, IDAYE, IHRE, IMINE, ISECE <font color=#447700>! Run end.<a name='448'></font>
    INTEGER,INTENT(IN):: DT_OUT <font color=#447700>! Model timestep size in seconds.<a name='449'></font>
    REAL,DIMENSION(IM):: RLON<a name='450'>
    REAL,DIMENSION(JM):: RLAT<a name='451'>
    REAL,DIMENSION(IM, JM):: H<a name='452'>
    INTEGER,DIMENSION(IM, JM),INTENT(IN):: FM<a name='453'>
    REAL,DIMENSION(NSL):: ZL, ZZ, DZ<a name='454'>
    <font color=#447700>! Locals:<a name='455'></font>
    REAL,DIMENSION(IM, JM, NSL):: TEMP_3D_H <font color=#447700>! VLA<a name='456'></font>
    INTEGER,DIMENSION(IM, JM, NSL):: TEMP_3D_FM <font color=#447700>! VLA<a name='457'></font>
    INTEGER IM_DIM, JM_DIM, NSL_DIM, NSTEPP1_DIM<a name='458'>
    INTEGER RLON_VAR, RLAT_VAR, H_VAR, H2_VAR, FM_VAR<a name='459'>
    INTEGER ZL_VAR, ZZ_VAR, DZ_VAR<a name='460'>
    INTEGER ERR, VARIABLE, DIM_IDS( 4 ), INFO<a name='461'>
    INTEGER I, J, K<a name='462'>
    REAL,DIMENSION(IM):: RLON_COPY<a name='463'>
    CHARACTER(LEN=40):: TIME_UNITS<a name='464'>
    FILE_ID = -1<a name='465'>
<a name='466'>
    <font color=#447700>! Create/overwrite NetCDF output file:<a name='467'></font>
    CALL MPI_INFO_CREATE( INFO, ERR )<a name='468'>
    CALL MPI_INFO_SET( INFO, 'ind_wr_buffer_size', '16777216', ERR )<a name='469'>
    ERR = NFMPI_CREATE( MPI_COMM_SELF, trim(NAME), &amp;<a name='470'>
                        IOR( NF_CLOBBER, NF_64BIT_OFFSET ), INFO, FILE_ID )<a name='471'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_51">( ERR, 'create NetCDF output file ' // NAME )<a name='472'>
    CALL MPI_INFO_FREE( INFO, ERR )<a name='473'>
<a name='474'>
    <font color=#447700>! Create dimensions:<a name='475'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFDIM'>DEFDIM</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFDIM_5">( FILE_ID, IM_DIM, 'longitude', IM )<a name='476'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFDIM'>DEFDIM</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFDIM_6">( FILE_ID, JM_DIM, 'latitude', JM )<a name='477'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFDIM'>DEFDIM</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFDIM_7">( FILE_ID, NSL_DIM, 'k', NSL )<a name='478'>
<font color=#447700>!!  CALL DEFDIM( FILE_ID, NSTEPP1_DIM, 'time', NSTEP )<a name='479'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFDIM'>DEFDIM</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFDIM_8">( FILE_ID, NSTEPP1_DIM, 'time', 0 ) <font color=#447700>! 0 Means UNLIMITED size.<a name='480'></font>
<a name='481'>
    <font color=#447700>! Write global scalar attributes:<a name='482'></font>
<a name='483'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_21">( FILE_ID, 'Run_Identifier', TRIM(CODE_ID) )<a name='484'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_16">( FILE_ID, 'nstep', NSTEP )<a name='485'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_17">( FILE_ID, 'iYr0', IYR0 )<a name='486'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_18">( FILE_ID, 'iYrS', IYRS )<a name='487'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_19">( FILE_ID, 'iMonS', IMONS )<a name='488'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_20">( FILE_ID, 'iDayS', IDAYS )<a name='489'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_21">( FILE_ID, 'iHrS', IHRS )<a name='490'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_22">( FILE_ID, 'iMinS', IMINS )<a name='491'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_23">( FILE_ID, 'iSecS', ISECS )<a name='492'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_24">( FILE_ID, 'iYrE', IYRE )<a name='493'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_25">( FILE_ID, 'iMonE', IMONE )<a name='494'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_26">( FILE_ID, 'iDayE', IDAYE )<a name='495'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_27">( FILE_ID, 'iHrE', IHRE )<a name='496'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_28">( FILE_ID, 'iMinE', IMINE )<a name='497'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_29">( FILE_ID, 'iSecE', ISECE )<a name='498'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_30">( FILE_ID, 'dT_out', DT_OUT )<a name='499'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_22">( FILE_ID, 'description1', &amp;<a name='500'>
      'Output from NCOM_GEM ' // &amp;<a name='501'>
      '(US Naval Coastal Ocean Model Gulf Ecology Model)' )<a name='502'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_23">( FILE_ID, 'description2', &amp;<a name='503'>
      'Dimension longitude: Number of cells in the longitudinal direction.' )<a name='504'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_24">( FILE_ID, 'description3', &amp;<a name='505'>
      'Dimension latitude: Number of cells in the latitudinal direction.' )<a name='506'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_25">( FILE_ID, 'description4', &amp;<a name='507'>
      'Dimension time: Number of timesteps. ' )<a name='508'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_26">( FILE_ID, 'description5', &amp;<a name='509'>
      'Attribute nstep: Number of model output timesteps excluding initial time.' )<a name='510'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_27">( FILE_ID, 'description6', &amp;<a name='511'>
      'Attribute iYr0: Reference year (YYYY) all timestamps are relative to.' )<a name='512'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_28">( FILE_ID, 'description7', &amp;<a name='513'>
      'Attribute iYrS: GMT year (YYYY) of start of simulation.' )<a name='514'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_29">( FILE_ID, 'description8', &amp;<a name='515'>
      'Attribute iMonS: GMT month (1-12) of start of simulation.' )<a name='516'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_30">( FILE_ID, 'description9', &amp;<a name='517'>
      'Attribute iDayS: GMT day of month (1-31) of start of simulation.' )<a name='518'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_31">( FILE_ID, 'description10', &amp;<a name='519'>
      'Attribute iHrS: GMT hour (0-23) of start of simulation.' )<a name='520'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_32">( FILE_ID, 'description11', &amp;<a name='521'>
      'Attribute iMinS: GMT minite (0-59) of start of simulation.' )<a name='522'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_33">( FILE_ID, 'description12', &amp;<a name='523'>
      'Attribute iSecS: GMT second (0-59) of start of simulation.' )<a name='524'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_34">( FILE_ID, 'description13', &amp;<a name='525'>
      'Attribute iYrE: GMT year (YYYY) of end of simulation.' )<a name='526'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_35">( FILE_ID, 'description14', &amp;<a name='527'>
      'Attribute iMonE: GMT month (1-12) of end of simulation.' )<a name='528'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_36">( FILE_ID, 'description15', &amp;<a name='529'>
      'Attribute iDayE: GMT day of month (1-31) of end of simulation.' )<a name='530'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_37">( FILE_ID, 'description16', &amp;<a name='531'>
      'Attribute iHrE: GMT hour (0-23) of end of simulation.' )<a name='532'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_38">( FILE_ID, 'description17', &amp;<a name='533'>
      'Attribute iMinE: GMT minite (0-59) of end of simulation.' )<a name='534'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_39">( FILE_ID, 'description18', &amp;<a name='535'>
      'Attribute iSecE: GMT second (0-59) of end of simulation.' )<a name='536'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_40">( FILE_ID, 'description19', &amp;<a name='537'>
      'Attribute dT_out: Number of seconds per output timestep.' )<a name='538'>
<a name='539'>
    <font color=#447700>! List Calibration Parameters<a name='540'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_41">( FILE_ID, 'Calibration0', 'Calibration Parameters used for this run.')<a name='541'>
<font color=#447700>!Switches in GEM<a name='542'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_42">( FILE_ID, 'Calibration1', 'Switches in GEM.')<a name='543'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_31">( FILE_ID, 'Which_fluxes(iO2surf)', Which_fluxes(iO2surf) )<a name='544'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_32">( FILE_ID, 'Which_fluxes(iDICsurf)', Which_fluxes(iDICsurf) )<a name='545'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_33">( FILE_ID, 'Which_fluxes(iSOC)', Which_fluxes(iSOC) )<a name='546'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_34">( FILE_ID, 'Which_fluxes(iMPB)', Which_fluxes(iMPB) )<a name='547'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_35">( FILE_ID, 'Which_fluxes(iNutEx)', Which_fluxes(iNutEx) )<a name='548'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_36">( FILE_ID, 'Which_fluxes(iCMAQ)', Which_fluxes(iCMAQ) )<a name='549'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_37">( FILE_ID, 'Which_fluxes(iInRemin)', Which_fluxes(iInRemin) )<a name='550'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_38">( FILE_ID, 'Which_fluxes(iSDM)', Which_fluxes(iSDM) )<a name='551'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_39">( FILE_ID, 'Which_temperature', Which_temperature )<a name='552'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_40">( FILE_ID, 'Which_uptake', Which_uptake  )<a name='553'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_41">( FILE_ID, 'Which_quota', Which_quota  )<a name='554'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_42">( FILE_ID, 'Calibration', Calibration  )<a name='555'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_43">( FILE_ID, 'Out_1D', Out_1D  )<a name='556'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_44">( FILE_ID, 'Which_irradiance', Which_irradiance  )<a name='557'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_45">( FILE_ID, 'Which_chlaC', Which_chlaC  )<a name='558'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_46">( FILE_ID, 'Which_photosynthesis', Which_photosynthesis  )<a name='559'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_47">( FILE_ID, 'Which_growth', Which_growth  )<a name='560'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_48">( FILE_ID, 'SolarRad', SolarRad  )<a name='561'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_49">( FILE_ID, 'InitializeHow', InitializeHow  )<a name='562'>
<font color=#447700>!Optics<a name='563'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_43">( FILE_ID, 'Calibration2', 'Optics in GEM.')<a name='564'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_1">( FILE_ID, 'Kw', Kw  )<a name='565'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_2">( FILE_ID, 'Kcdom', Kcdom  )<a name='566'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_3">( FILE_ID, 'Kspm', Kspm  )<a name='567'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_4">( FILE_ID, 'Kchla', Kchla  )<a name='568'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_5">( FILE_ID, 'astar490', astar490  )<a name='569'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_6">( FILE_ID, 'aw490', aw490  )<a name='570'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_7">( FILE_ID, 'astarOMA', astarOMA  )<a name='571'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_8">( FILE_ID, 'astarOMZ', astarOMZ  )<a name='572'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_9">( FILE_ID, 'astarOMR', astarOMR  )<a name='573'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_10">( FILE_ID, 'astarOMBC', astarOMBC  )<a name='574'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_11">( FILE_ID, 'sink CDOM', ws(iCDOM)  )<a name='575'>
<font color=#447700>!Temperature<a name='576'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_44">( FILE_ID, 'Calibration3', 'Temperature in GEM.')<a name='577'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT8'>DEFRAT8</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT8_1">( FILE_ID, 'Tref', Tref )<a name='578'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT8'>DEFRAT8</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT8_2">( FILE_ID, 'KTg1', KTg1 )<a name='579'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT8'>DEFRAT8</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT8_3">( FILE_ID, 'KTg2', KTg2 )<a name='580'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT8'>DEFRAT8</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT8_4">( FILE_ID, 'Ea_R', Ea_R )<a name='581'>
<font color=#447700>!Phytoplankton<a name='582'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_45">( FILE_ID, 'Calibration4', 'Phytoplankton in GEM.')<a name='583'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_1">( FILE_ID, 'ediblevector1', ediblevector(1,:) )<a name='584'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_2">( FILE_ID, 'ediblevector2', ediblevector(2,:) )<a name='585'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_3">( FILE_ID, 'umax', umax )<a name='586'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_4">( FILE_ID, 'alpha', alpha )<a name='587'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_5">( FILE_ID, 'beta', beta )<a name='588'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_6">( FILE_ID, 'respg', respg )<a name='589'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_7">( FILE_ID, 'respb', respb )<a name='590'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_8">( FILE_ID, 'QminN', QminN  )<a name='591'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_9">( FILE_ID, 'QminP', QminP )<a name='592'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_10">( FILE_ID, 'QmaxN', QmaxN )<a name='593'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_11">( FILE_ID, 'QmaxP', QmaxP  )<a name='594'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_12">( FILE_ID, 'Kn', Kn  )<a name='595'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_13">( FILE_ID, 'Kp', Kp  )<a name='596'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_14">( FILE_ID, 'Ksi', Ksi  )<a name='597'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_15">( FILE_ID, 'KQn', KQn )<a name='598'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_16">( FILE_ID, 'KQp', KQp  )<a name='599'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_17">( FILE_ID, 'nfQs', nfQs )<a name='600'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_18">( FILE_ID, 'vmaxN', vmaxN  )<a name='601'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_19">( FILE_ID, 'vmaxP', vmaxP  )<a name='602'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_20">( FILE_ID, 'vmaxSi', vmaxSi  )<a name='603'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_21">( FILE_ID, 'aN', aN )<a name='604'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_22">( FILE_ID, 'volcell', volcell  )<a name='605'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_23">( FILE_ID, 'Qc', Qc  )<a name='606'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_24">( FILE_ID, 'Athresh', Athresh )<a name='607'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_25">( FILE_ID, 'sink A', ws(iA1:iA6)  )<a name='608'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT6'>DEFRAT6</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT6_26">( FILE_ID, 'mA', mA )<a name='609'>
<a name='610'>
<font color=#447700>!Zooplankton<a name='611'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_46">( FILE_ID, 'Calibration5', 'Zooplankton in GEM.')<a name='612'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_1">( FILE_ID, 'Zeffic', Zeffic )<a name='613'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_2">( FILE_ID, 'Zslop', Zslop )<a name='614'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_3">( FILE_ID, 'Zvolcell', Zvolcell )<a name='615'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_4">( FILE_ID, 'ZQc', ZQc )<a name='616'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_5">( FILE_ID, 'ZQn', ZQn )<a name='617'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_6">( FILE_ID, 'ZQp', ZQp )<a name='618'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_7">( FILE_ID, 'ZKa', ZKa )<a name='619'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_8">( FILE_ID, 'Zrespg', Zrespg )<a name='620'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_9">( FILE_ID, 'Zrespb', Zrespb )<a name='621'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_10">( FILE_ID, 'Zumax', Zumax )<a name='622'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT2'>DEFRAT2</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT2_11">( FILE_ID, 'Zm', Zm )<a name='623'>
<a name='624'>
<font color=#447700>!Organic Matter<a name='625'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_47">( FILE_ID, 'Calibration6', 'Optics in GEM.')<a name='626'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_12">( FILE_ID, 'KG1', KG1  )<a name='627'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_13">( FILE_ID, 'KG2', KG2 )<a name='628'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_14">( FILE_ID, 'KG1_R', KG1_R  )<a name='629'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_15">( FILE_ID, 'KG2_R', KG2_R  )<a name='630'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_16">( FILE_ID, 'KG1_BC', KG1_BC  )<a name='631'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_17">( FILE_ID, 'KG2_BC', KG2_BC  )<a name='632'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_18">( FILE_ID, 'KNH4', KNH4 )<a name='633'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_19">( FILE_ID, 'nitmax', nitmax )<a name='634'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_20">( FILE_ID, 'KO2', KO2 )<a name='635'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_21">( FILE_ID, 'KstarO2', KstarO2  )<a name='636'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_22">( FILE_ID, 'KNO3', KNO3  )<a name='637'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_23">( FILE_ID, 'pCO2', pCO2  )<a name='638'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_24">( FILE_ID, 'stoich_x1R', stoich_x1R  )<a name='639'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_25">( FILE_ID, 'stoich_y1R', stoich_y1R  )<a name='640'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_26">( FILE_ID, 'stoich_x2R', stoich_x2R  )<a name='641'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_27">( FILE_ID, 'stoich_y2R', stoich_y2R )<a name='642'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_28">( FILE_ID, 'stoich_x1BC', stoich_x1BC  )<a name='643'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_29">( FILE_ID, 'stoich_y1BC', stoich_y1BC  )<a name='644'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_30">( FILE_ID, 'stoich_x2BC', stoich_x2BC  )<a name='645'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_31">( FILE_ID, 'stoich_y2BC', stoich_y2BC )<a name='646'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_32">( FILE_ID, 'sink OM1_A', ws(iOM1_A) )<a name='647'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_33">( FILE_ID, 'sink OM2_A', ws(iOM2_A)  )<a name='648'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_34">( FILE_ID, 'sink OM1_Z', ws(iOM1_Z)  )<a name='649'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_35">( FILE_ID, 'sink OM2_Z', ws(iOM2_Z)  )<a name='650'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_36">( FILE_ID, 'sink OM1_R', ws(iOM1_R) )<a name='651'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_37">( FILE_ID, 'sink OM2_R', ws(iOM2_R) )<a name='652'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_38">( FILE_ID, 'sink OM1_BC', ws(iOM1_BC) )<a name='653'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_39">( FILE_ID, 'sink OM2_BC', ws(iOM2_BC) )<a name='654'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_40">( FILE_ID, 'KGcdom', KGcdom  )<a name='655'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_41">( FILE_ID, 'CF_SPM',CF_SPM )<a name='656'>
<font color=#447700>!River Loads<a name='657'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_48">( FILE_ID, 'Calibration7', 'River Loads in GEM.')<a name='658'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_42">( FILE_ID, 'rcNO3', rcNO3 )<a name='659'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_43">( FILE_ID, 'rcNH4', rcNH4 )<a name='660'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_44">( FILE_ID, 'rcPO4', rcPO4 )<a name='661'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_45">( FILE_ID, 'rcSi',  rcSi  )<a name='662'>
<font color=#447700>!Other Including Boundary Conditions<a name='663'></font>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFTAT'>DEFTAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFTAT_49">( FILE_ID, 'Calibration8', 'Other Including Boundary Conditions in GEM.')<a name='664'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_50">( FILE_ID, 'Which_VMix', Which_VMix  )<a name='665'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_46">( FILE_ID, 'KH_coeff', KH_coeff )<a name='666'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFIAT'>DEFIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFIAT_51">( FILE_ID, 'Which_Outer_BC', Which_Outer_BC  )<a name='667'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_47">( FILE_ID, 'm_OM_init', m_OM_init )<a name='668'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_48">( FILE_ID, 'm_OM_BC', m_OM_BC )<a name='669'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_49">( FILE_ID, 'm_OM_sh', m_OM_sh )<a name='670'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_50">( FILE_ID, 'Stoich_x1A_init', Stoich_x1A_init )<a name='671'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_51">( FILE_ID, 'Stoich_y1A_init', Stoich_y1A_init )<a name='672'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_52">( FILE_ID, 'Stoich_x2A_init', Stoich_x2A_init )<a name='673'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_53">( FILE_ID, 'Stoich_y2A_init', Stoich_y2A_init )<a name='674'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_54">( FILE_ID, 'Stoich_x1Z_init', Stoich_x1Z_init  )<a name='675'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_55">( FILE_ID, 'Stoich_y1Z_init', Stoich_y1Z_init  )<a name='676'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_56">( FILE_ID, 'Stoich_x2Z_init', Stoich_x2Z_init  )<a name='677'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_57">( FILE_ID, 'Stoich_y2Z_init', Stoich_y2Z_init  )<a name='678'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFRAT'>DEFRAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFRAT_58">( FILE_ID, 'KG_bot', KG_bot  )<a name='679'>
<a name='680'>
    <font color=#447700>! Define non-time-varying array variables:<a name='681'></font>
<a name='682'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR1'>DEFVR1</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR1_3">( FILE_ID, IM_DIM, RLON_VAR, 'longitude', &amp;<a name='683'>
                 'Cell center longitude [-180, 180].', 'deg' )<a name='684'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR1'>DEFVR1</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR1_4">( FILE_ID, JM_DIM, RLAT_VAR, 'latitude', &amp;<a name='685'>
                 'Cell center latitude [-90, 90].', 'deg' )<a name='686'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR3'>DEFVR3</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR3_2">( FILE_ID, IM_DIM, JM_DIM, NSL_DIM, H_VAR, 'h', &amp;<a name='687'>
                 'Cell center depth.', 'm' )<a name='688'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR3'>DEFVR3</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR3_3">( FILE_ID, IM_DIM, JM_DIM, NSL_DIM, H2_VAR, 'h_actual', &amp;<a name='689'>
                 'Actual cell center depth.', 'm' )<a name='690'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVI3'>DEFVI3</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVI3_1">( FILE_ID, IM_DIM, JM_DIM, NSL_DIM, FM_VAR, 'fm', &amp;<a name='691'>
                 'Mask: 0 = land, 1 = water.', 'none' )<a name='692'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR1'>DEFVR1</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR1_5">( FILE_ID, NSL_DIM, ZL_VAR, 'zl', &amp;<a name='693'>
                 'Sigma value of top of layer.', 'none' )<a name='694'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR1'>DEFVR1</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR1_6">( FILE_ID, NSL_DIM, ZZ_VAR, 'zz', &amp;<a name='695'>
                 'Sigma value of middle of layer.', 'none' )<a name='696'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR1'>DEFVR1</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR1_7">( FILE_ID, NSL_DIM, DZ_VAR, 'dz', &amp;<a name='697'>
                 'Relative Sigma layer thickness.', 'none' )<a name='698'>
<a name='699'>
    <font color=#447700>! Define time array variable as each output data's seconds since IYR0:<a name='700'></font>
<a name='701'>
    WRITE ( TIME_UNITS, '(A,I4.4,A)' ) &amp;<a name='702'>
            'Seconds since ', iYr0, '-01-01 00:00:00Z'<a name='703'>
<a name='704'>
    <font color=#447700>! Note: this is defined as an 8-byte real in the file<a name='705'></font>
    <font color=#447700>! because NetCDF does not support 8-byte integers.<a name='706'></font>
    <font color=#447700>! Its value is converted to/from interger during reads/writes.<a name='707'></font>
<a name='708'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVD1'>DEFVD1</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVD1_2">( FILE_ID, NSTEPP1_DIM, TIME_VAR, 'time', &amp;<a name='709'>
                 TRIM( TIME_UNITS ), TRIM( TIME_UNITS ) )<a name='710'>
<a name='711'>
    <font color=#447700>! Define time-varying array variables:<a name='712'></font>
<a name='713'>
    DIM_IDS( 1 ) = IM_DIM<a name='714'>
    DIM_IDS( 2 ) = JM_DIM<a name='715'>
    DIM_IDS( 3 ) = NSL_DIM<a name='716'>
    DIM_IDS( 4 ) = NSTEPP1_DIM<a name='717'>
<a name='718'>
    DO VARIABLE = 1, VARIABLES<a name='719'>
<a name='720'>
      IF ( WRITE_VARIABLE( VARIABLE ) ) THEN<a name='721'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR4'>DEFVR4</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR4_2">( FILE_ID, DIM_IDS, F_VAR( VARIABLE ), &amp;<a name='722'>
                     TRIM( VARIABLE_NAMES( VARIABLE ) ), &amp;<a name='723'>
                     TRIM( VARIABLE_DESCRIPTIONS( VARIABLE ) ), &amp;<a name='724'>
                     TRIM( VARIABLE_UNITS( VARIABLE ) ) )<a name='725'>
      END IF<a name='726'>
    END DO<a name='727'>
<a name='728'>
<a name='729'>
    <font color=#447700>! Define extra time-varying array variables:<a name='730'></font>
<a name='731'>
    DIM_IDS( 1 ) = IM_DIM<a name='732'>
    DIM_IDS( 2 ) = JM_DIM<a name='733'>
    DIM_IDS( 3 ) = NSL_DIM<a name='734'>
    DIM_IDS( 4 ) = NSTEPP1_DIM<a name='735'>
<a name='736'>
    DO VARIABLE = 1, EXTRA_VARIABLES<a name='737'>
<a name='738'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='739'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#DEFVR4'>DEFVR4</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFVR4_3">( FILE_ID, DIM_IDS, EXTRA_VAR( VARIABLE ), &amp;<a name='740'>
                   TRIM( EXTRA_VARIABLE_NAMES( VARIABLE ) ), &amp;<a name='741'>
                   TRIM( EXTRA_VARIABLE_DESCRIPTIONS( VARIABLE ) ), &amp;<a name='742'>
                   TRIM( EXTRA_VARIABLE_UNITS( VARIABLE ) ) )<a name='743'>
      END IF<a name='744'>
    END DO<a name='745'>
<a name='746'>
    <font color=#447700>! End of NetCDF header:<a name='747'></font>
<a name='748'>
    ERR = NFMPI_ENDDEF( FILE_ID )<a name='749'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_52">( ERR, 'create NetCDF output header' )<a name='750'>
    ERR = NFMPI_BEGIN_INDEP_DATA( FILE_ID )<a name='751'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_53">( ERR, 'begin independent data access mode' )<a name='752'>
<a name='753'>
    <font color=#447700>! Write non-time-varying array variables:<a name='754'></font>
<a name='755'>
    RLON_COPY = RLON<a name='756'>
<a name='757'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CONVERT_LONGITUDES'>CONVERT_LONGITUDES</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CONVERT_LONGITUDES_2">( IM, RLON_COPY )<a name='758'>
<a name='759'>
    ERR = NFMPI_PUT_VAR_REAL( FILE_ID, RLON_VAR, RLON_COPY )<a name='760'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_54">( ERR, 'write output variable rlon' )<a name='761'>
<a name='762'>
    ERR = NFMPI_PUT_VAR_REAL( FILE_ID, RLAT_VAR, RLAT )<a name='763'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_55">( ERR, 'write output variable rlat' )<a name='764'>
<a name='765'>
    <font color=#447700>! Write h in 3D<a name='766'></font>
<a name='767'>
    DO K = 1, NSL<a name='768'>
      TEMP_3D_H(:,:,K) = H<a name='769'>
    END DO<a name='770'>
    ERR = NFMPI_PUT_VAR_REAL( FILE_ID, H_VAR, TEMP_3D_H )<a name='771'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_56">( ERR, 'write output variable h' )<a name='772'>
<a name='773'>
    <font color=#447700>! Write actual h in 3D<a name='774'></font>
<a name='775'>
    DO K = 1, NSL<a name='776'>
      DO J = 1, JM<a name='777'>
        DO I = 1, IM<a name='778'>
          IF (H(I, J) .LT. 0) THEN  <font color=#447700>! land cells<a name='779'></font>
            TEMP_3D_H(I,J,K) = H(I,J)<a name='780'>
          ELSE     <font color=#447700>! water cells<a name='781'></font>
            TEMP_3D_H(I,J,K) = H(I,J) * (K - 1) / 20<a name='782'>
          END IF<a name='783'>
        END DO<a name='784'>
      END DO<a name='785'>
    END DO<a name='786'>
    ERR = NFMPI_PUT_VAR_REAL( FILE_ID, H2_VAR, TEMP_3D_H )<a name='787'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_57">( ERR, 'write output variable h_actual' )<a name='788'>
<a name='789'>
    <font color=#447700>! Write fm in 3D<a name='790'></font>
<a name='791'>
    DO K = 1, NSL<a name='792'>
      TEMP_3D_FM(:,:,K) = FM<a name='793'>
    END DO<a name='794'>
    ERR = NFMPI_PUT_VAR_INT( FILE_ID, FM_VAR, TEMP_3D_FM )<a name='795'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_58">( ERR, 'write output variable fm' )<a name='796'>
<a name='797'>
    ERR = NFMPI_PUT_VAR_REAL( FILE_ID, ZL_VAR, ZL )<a name='798'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_59">( ERR, 'write output variable zl' )<a name='799'>
    ERR = NFMPI_PUT_VAR_REAL( FILE_ID, ZZ_VAR, ZZ )<a name='800'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_60">( ERR, 'write output variable zz' )<a name='801'>
    ERR = NFMPI_PUT_VAR_REAL( FILE_ID, DZ_VAR, DZ )<a name='802'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_61">( ERR, 'write output variable dz' )<a name='803'>
    CALL <A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#FLUSH_FILE'>FLUSH_FILE</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CREATE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FLUSH_FILE_1">()<a name='804'>
<a name='805'>
<a name='806'>
    RETURN<a name='807'>
  END SUBROUTINE CREATE_FILE<a name='808'>
<a name='809'>
<a name='810'>
<a name='811'>
  <font color=#447700>! OPEN_FILE: Open existing output NetCDF file for shared writing.<a name='812'></font>
  <font color=#447700>! In a concurrent program, each worker process should call<a name='813'></font>
  <font color=#447700>! OPEN_FILE, WRITE_SUBSET_DATA, CLOSE_FILE.<a name='814'></font>
  <font color=#447700>! FIRST_TIMESTEP is 0-based timestep number to begin writing.<a name='815'></font>
  <font color=#447700>!<a name='816'></font>
<A NAME='OPEN_FILE'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='817'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>OPEN_FILE</font>( NAME, FIRST_TIMESTEP ) <A href='../../call_to/OPEN_FILE.html' TARGET='index'>6</A>,<A href='../../call_from/OPEN_FILE.html' TARGET='index'>13</A><a name='818'>
    IMPLICIT NONE<a name='819'>
    CHARACTER(LEN=*),INTENT(IN):: NAME<a name='820'>
    INTEGER,INTENT(IN):: FIRST_TIMESTEP<a name='821'>
    <font color=#447700>! Locals:<a name='822'></font>
    INTEGER ERR, VARIABLE, INFO<a name='823'>
    INTEGER DT_OUT<a name='824'>
    INTEGER IYR0 <font color=#447700>! Reference year (before start of model run).<a name='825'></font>
    INTEGER IYRS, IMONS, IDAYS, IHRS, IMINS, ISECS <font color=#447700>! Run start.<a name='826'></font>
    INTEGER(8) SECONDS_FROM_YEAR0<a name='827'>
<a name='828'>
    CALL MPI_INFO_CREATE( INFO, ERR )<a name='829'>
    CALL MPI_INFO_SET( INFO, 'ind_wr_buffer_size', '16777216', ERR )<a name='830'>
<a name='831'>
    <font color=#447700>! Open existing shared 64-bit NetCDF output file for writing:<a name='832'></font>
<a name='833'>
    ERR = NFMPI_OPEN( MPI_COMM_WORLD, trim(NAME), &amp;<a name='834'>
                      IOR( NF_WRITE, NF_64BIT_OFFSET ), INFO, FILE_ID )<a name='835'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_62">( ERR, 'open existing shared writable output file ' // NAME )<a name='836'>
    CALL MPI_INFO_FREE( INFO, ERR )<a name='837'>
<a name='838'>
    <font color=#447700>! Get time variable id:<a name='839'></font>
<a name='840'>
    ERR = NFMPI_INQ_VARID( FILE_ID, 'time', TIME_VAR )<a name='841'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_63">( ERR, 'inquire NetCDF variable ID ' )<a name='842'>
<a name='843'>
    <font color=#447700>! Read time attributes to compute SECONDS0:<a name='844'></font>
<a name='845'>
    DT_OUT = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_10">( FILE_ID, 'dT_out' )<a name='846'>
    IYR0   = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_11">( FILE_ID, 'iYr0' )<a name='847'>
    IYRS   = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_12">( FILE_ID, 'iYrS' )<a name='848'>
    IMONS  = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_13">( FILE_ID, 'iMonS' )<a name='849'>
    IDAYS  = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_14">( FILE_ID, 'iDayS' )<a name='850'>
    IHRS   = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_15">( FILE_ID, 'iHrS' )<a name='851'>
    IMINS  = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_16">( FILE_ID, 'iMinS' )<a name='852'>
    ISECS  = <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#READIAT'>READIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READIAT_17">( FILE_ID, 'iSecS' )<a name='853'>
    SECONDS_FROM_YEAR0 = &amp;<a name='854'>
      <A href='../../html_code/CGEM_2.0/DATE_TIME.f.html#TOTAL_SECONDS'>TOTAL_SECONDS</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TOTAL_SECONDS_27">( IYR0, IYRS, IMONS, IDAYS, IHRS, IMINS, ISECS )<a name='855'>
<a name='856'>
    FILE_FIRST_TIMESTEP = FIRST_TIMESTEP <font color=#447700>! 0-based model timestep of this file.<a name='857'></font>
    SECONDS_PER_TIMESTEP = DT_OUT<a name='858'>
    SECONDS0 = SECONDS_PER_TIMESTEP<a name='859'>
    SECONDS0 = SECONDS0 * FILE_FIRST_TIMESTEP<a name='860'>
    SECONDS0 = SECONDS0 + SECONDS_FROM_YEAR0<a name='861'>
<a name='862'>
    <font color=#447700>! Get time-varying array variable ids:<a name='863'></font>
<a name='864'>
    DO VARIABLE = 1, VARIABLES<a name='865'>
<a name='866'>
      IF ( WRITE_VARIABLE( VARIABLE ) ) THEN<a name='867'>
        ERR = NFMPI_INQ_VARID( FILE_ID, VARIABLE_NAMES( VARIABLE ), &amp;<a name='868'>
                               F_VAR( VARIABLE ) )<a name='869'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_64">( ERR, 'inquire NetCDF variable ID ' )<a name='870'>
      END IF<a name='871'>
    END DO<a name='872'>
<a name='873'>
    <font color=#447700>! Get time-varying extra array variable ids:<a name='874'></font>
<a name='875'>
    DO VARIABLE = 1, EXTRA_VARIABLES<a name='876'>
<a name='877'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='878'>
        ERR = NFMPI_INQ_VARID( FILE_ID, EXTRA_VARIABLE_NAMES( VARIABLE ), &amp;<a name='879'>
                               EXTRA_VAR( VARIABLE ) )<a name='880'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#OPEN_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_65">( ERR, 'inquire NetCDF variable ID ' )<a name='881'>
      END IF<a name='882'>
    END DO<a name='883'>
<a name='884'>
    RETURN<a name='885'>
  END SUBROUTINE OPEN_FILE<a name='886'>
<a name='887'>
<a name='888'>
<a name='889'>
  <font color=#447700>! CLOSE_FILE: Close output file.<a name='890'></font>
  <font color=#447700>!<a name='891'></font>
<A NAME='CLOSE_FILE'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CLOSE_FILE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='892'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>CLOSE_FILE</font>() <A href='../../call_to/CLOSE_FILE.html' TARGET='index'>7</A>,<A href='../../call_from/CLOSE_FILE.html' TARGET='index'>1</A><a name='893'>
    IMPLICIT NONE<a name='894'>
    INTEGER ERR<a name='895'>
<a name='896'>
    ERR = NFMPI_CLOSE( FILE_ID )<a name='897'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#CLOSE_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_66">( ERR, 'close NetCDF output file ' )<a name='898'>
    FILE_ID = -1<a name='899'>
<a name='900'>
    RETURN<a name='901'>
  END SUBROUTINE CLOSE_FILE<a name='902'>
<a name='903'>
<a name='904'>
<a name='905'>
  <font color=#447700>! WRITE_SUBSET_DATA: Write current timestep data to output file.<a name='906'></font>
  <font color=#447700>! This routine should be called when concurrent processes write a subset<a name='907'></font>
  <font color=#447700>! of data, e.g., if the domain is decomposed by columns and there are<a name='908'></font>
  <font color=#447700>! 320 columns in the full grid and each of 4 processes holds 80 columns<a name='909'></font>
  <font color=#447700>! the last process call for timestep 1000 looks like:<a name='910'></font>
  <font color=#447700>! CALL WRITE_SUBSET_DATA( 240, 80, 1, 176, 1, 27, 1000, FF )<a name='911'></font>
  <font color=#447700>!<a name='912'></font>
<A NAME='WRITE_SUBSET_DATA'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_SUBSET_DATA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='913'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>WRITE_SUBSET_DATA</font>( ISTART, IM, JSTART, JM, ZSTART, NSL, &amp; <A href='../../call_to/WRITE_SUBSET_DATA.html' TARGET='index'>4</A>,<A href='../../call_from/WRITE_SUBSET_DATA.html' TARGET='index'>5</A><a name='914'>
                                TIMESTEP, F )<a name='915'>
    IMPLICIT NONE<a name='916'>
    INTEGER,INTENT(IN):: ISTART, JSTART, ZSTART<a name='917'>
    INTEGER,INTENT(IN):: IM, JM, NSL, TIMESTEP <font color=#447700>! Model TIMESTEP is 0-based.<a name='918'></font>
    REAL,DIMENSION(IM, JM, NSL, VARIABLES):: F<a name='919'>
    <font color=#447700>! Locals:<a name='920'></font>
    REAL(8):: SECONDS(1) <font color=#447700>! TIME_VAR.<a name='921'></font>
    INTEGER(MPI_OFFSET_KIND):: STARTS( 4 ), COUNTS( 4 )<a name='922'>
    INTEGER ERR, VARIABLE, FILE_TIMESTEP<a name='923'>
    INTEGER,DIMENSION(VARIABLES + 1):: REQUESTS, STATUSES<a name='924'>
    INTEGER REQUEST_COUNT, REQUEST<a name='925'>
<a name='926'>
    FILE_TIMESTEP = TIMESTEP - FILE_FIRST_TIMESTEP<a name='927'>
<a name='928'>
    <font color=#447700>! Write time variable as an 8-byte real since NetCDF lacks 8-byte integer:<a name='929'></font>
<a name='930'>
    STARTS( 1 ) = FILE_TIMESTEP + 1<a name='931'>
    COUNTS( 1 ) = 1<a name='932'>
    SECONDS( 1 ) = SECONDS0 + FILE_TIMESTEP * SECONDS_PER_TIMESTEP<a name='933'>
    ERR = NFMPI_IPUT_VARA_DOUBLE( FILE_ID, TIME_VAR, STARTS, COUNTS, &amp;<a name='934'>
                                  SECONDS, REQUESTS( 1 ) )<a name='935'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_SUBSET_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_67">( ERR, 'write output variable time' )<a name='936'>
<a name='937'>
    REQUEST_COUNT = 1<a name='938'>
<a name='939'>
    STARTS( 1 ) = ISTART<a name='940'>
    STARTS( 2 ) = JSTART<a name='941'>
    STARTS( 3 ) = ZSTART<a name='942'>
    STARTS( 4 ) = FILE_TIMESTEP + 1 <font color=#447700>! NetCDF follows FORTRAN 1-based convention<a name='943'></font>
    COUNTS( 1 ) = IM<a name='944'>
    COUNTS( 2 ) = JM<a name='945'>
    COUNTS( 3 ) = NSL<a name='946'>
    COUNTS( 4 ) = 1<a name='947'>
<a name='948'>
    DO VARIABLE = 1, VARIABLES<a name='949'>
<a name='950'>
      IF ( WRITE_VARIABLE( VARIABLE ) ) THEN<a name='951'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='952'>
        ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, F_VAR( VARIABLE ), &amp;<a name='953'>
                  STARTS, COUNTS, F( 1, 1, 1, VARIABLE ), &amp;<a name='954'>
                  REQUESTS( REQUEST_COUNT ))<a name='955'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_SUBSET_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_68">( ERR, 'write output variable ' // VARIABLE_NAMES(VARIABLE))<a name='956'>
      END IF<a name='957'>
    END DO<a name='958'>
<a name='959'>
    ERR = NFMPI_WAIT_ALL( FILE_ID, REQUEST_COUNT, REQUESTS, STATUSES )<a name='960'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_SUBSET_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_69">( ERR, 'implement non-blocking interface' )<a name='961'>
<a name='962'>
    <font color=#447700>! check status of each nonblocking call<a name='963'></font>
<a name='964'>
    DO REQUEST = 1, REQUEST_COUNT<a name='965'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_SUBSET_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_70">( STATUSES( REQUEST ), 'nonblocking call ' )<a name='966'>
    END DO<a name='967'>
<a name='968'>
    CALL <A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#FLUSH_FILE'>FLUSH_FILE</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_SUBSET_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FLUSH_FILE_2">() <font color=#447700>! Flush buffers to disk in case of crash.<a name='969'></font>
<a name='970'>
    RETURN<a name='971'>
  END SUBROUTINE WRITE_SUBSET_DATA<a name='972'>
<a name='973'>
<a name='974'>
<a name='975'>
  <font color=#447700>! READ_DATA: Read given timestep data from an existing file.<a name='976'></font>
  <font color=#447700>! This routine should be called when concurrent processes read a subset<a name='977'></font>
  <font color=#447700>! of data, during a restart.<a name='978'></font>
  <font color=#447700>! E.g., if the domain is decomposed by columns and there are<a name='979'></font>
  <font color=#447700>! 320 columns in the full grid and each of 4 processes holds 80 columns<a name='980'></font>
  <font color=#447700>! the last process call for timestep 1000 looks like:<a name='981'></font>
  <font color=#447700>! CALL READ_DATA( NAME, 240, 80, 1, 176, 1, 27, 1000, FF )<a name='982'></font>
  <font color=#447700>!<a name='983'></font>
<A NAME='READ_DATA'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_DATA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='984'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>READ_DATA</font>( NAME, ISTART, IM, JSTART, JM, ZSTART, NSL, TIMESTEP, F) <A href='../../call_to/READ_DATA.html' TARGET='index'>2</A>,<A href='../../call_from/READ_DATA.html' TARGET='index'>4</A><a name='985'>
    IMPLICIT NONE<a name='986'>
    CHARACTER(LEN=*),INTENT(IN):: NAME<a name='987'>
    INTEGER,INTENT(IN):: ISTART, JSTART, ZSTART<a name='988'>
    INTEGER,INTENT(IN):: IM, JM, NSL, TIMESTEP <font color=#447700>! NetCDF TIMESTEP is 1-based.<a name='989'></font>
    REAL,DIMENSION(IM, JM, NSL, VARIABLES):: F<a name='990'>
    <font color=#447700>! Locals:<a name='991'></font>
    INTEGER(MPI_OFFSET_KIND):: STARTS( 4 ), COUNTS( 4 )<a name='992'>
    INTEGER INFO, ERR, ID, VARIABLE_ID, VARIABLE<a name='993'>
<a name='994'>
    <font color=#447700>! Open existing 64-bit NetCDF file for reading:<a name='995'></font>
<a name='996'>
    CALL MPI_INFO_CREATE( INFO, ERR )<a name='997'>
    CALL MPI_INFO_SET( INFO, 'ind_rd_buffer_size', '16777216', ERR )<a name='998'>
    ERR = NFMPI_OPEN( MPI_COMM_WORLD, trim(NAME), &amp;<a name='999'>
                      IOR( NF_NOWRITE, NF_64BIT_OFFSET ), INFO, ID )<a name='1000'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_71">( ERR, 'open existing file ' // NAME )<a name='1001'>
    CALL MPI_INFO_FREE( INFO, ERR )<a name='1002'>
<a name='1003'>
    STARTS( 1 ) = ISTART<a name='1004'>
    STARTS( 2 ) = JSTART<a name='1005'>
    STARTS( 3 ) = ZSTART<a name='1006'>
    STARTS( 4 ) = TIMESTEP<a name='1007'>
    COUNTS( 1 ) = IM<a name='1008'>
    COUNTS( 2 ) = JM<a name='1009'>
    COUNTS( 3 ) = NSL<a name='1010'>
    COUNTS( 4 ) = 1<a name='1011'>
<a name='1012'>
    DO VARIABLE = 1, VARIABLES<a name='1013'>
<a name='1014'>
      IF ( WRITE_VARIABLE( VARIABLE ) ) THEN<a name='1015'>
        ERR = NFMPI_INQ_VARID( ID, VARIABLE_NAMES( VARIABLE ), VARIABLE_ID )<a name='1016'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_72">( ERR, 'inquire NetCDF variable ID ' )<a name='1017'>
        ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, &amp;<a name='1018'>
                                   STARTS, COUNTS, F( 1, 1, 1, VARIABLE ) )<a name='1019'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_73">( ERR, 'read variable ' // VARIABLE_NAMES( VARIABLE ) )<a name='1020'>
      END IF<a name='1021'>
    END DO<a name='1022'>
<a name='1023'>
    ERR = NFMPI_CLOSE( ID )<a name='1024'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_74">( ERR, 'close NetCDF file ' )<a name='1025'>
    RETURN<a name='1026'>
  END SUBROUTINE READ_DATA<a name='1027'>
<a name='1028'>
<a name='1029'>
<a name='1030'>
  <font color=#447700>! WRITE_EXTRA_DATA: Write current timestep data to output file.<a name='1031'></font>
  <font color=#447700>! Called by concurrent programs to write all data per timestep<a name='1032'></font>
  <font color=#447700>! though only one process (PROCESS_ID 0) will write the extra data.<a name='1033'></font>
  <font color=#447700>!<a name='1034'></font>
<A NAME='WRITE_EXTRA_DATA'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1035'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>WRITE_EXTRA_DATA</font>( ISTART, IM, JSTART, JM, ZSTART, NSL, SPECIES, &amp; <A href='../../call_to/WRITE_EXTRA_DATA.html' TARGET='index'>2</A>,<A href='../../call_from/WRITE_EXTRA_DATA.html' TARGET='index'>22</A><a name='1036'>
                               TIMESTEP, IRRADIANCE, IRRADIANCE_FRACTION,    &amp;<a name='1037'>
                               UN, UP, UE, UA, CHLA_MG_TOT,                  &amp;<a name='1038'>
                               S_X1A, S_Y1A, S_X2A, S_Y2A,                   &amp;<a name='1039'>
                               S_X1FP, S_Y1FP, S_X2FP, S_Y2FP, USI, ChlC, pH,&amp;<a name='1040'>
                               RN2 )<a name='1041'>
    IMPLICIT NONE<a name='1042'>
    INTEGER,INTENT(IN):: ISTART, JSTART, ZSTART<a name='1043'>
    INTEGER,INTENT(IN):: IM, JM, NSL, SPECIES, TIMESTEP<a name='1044'>
    REAL,DIMENSION(IM, JM, NSL):: IRRADIANCE<a name='1045'>
    REAL,DIMENSION(IM, JM, NSL):: IRRADIANCE_FRACTION<a name='1046'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UN<a name='1047'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UP<a name='1048'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UE<a name='1049'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UA<a name='1050'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: USI<a name='1051'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: ChlC <a name='1052'>
    REAL,DIMENSION(IM, JM, NSL):: CHLA_MG_TOT<a name='1053'>
    REAL,DIMENSION(IM, JM, NSL):: S_X1A, S_Y1A, S_X2A, S_Y2A<a name='1054'>
    REAL,DIMENSION(IM, JM, NSL):: S_X1FP, S_Y1FP, S_X2FP, S_Y2FP<a name='1055'>
    REAL,DIMENSION(IM, JM, NSL):: pH<a name='1056'>
    REAL,DIMENSION(IM, JM, NSL):: RN2<a name='1057'>
    <font color=#447700>! Locals:<a name='1058'></font>
    INTEGER(MPI_OFFSET_KIND):: STARTS( 4 ), COUNTS( 4 )<a name='1059'>
    INTEGER ERR, FILE_TIMESTEP, VARIABLE, INDEX<a name='1060'>
    INTEGER,DIMENSION(EXTRA_VARIABLES):: REQUESTS, STATUSES<a name='1061'>
    INTEGER REQUEST_COUNT, REQUEST<a name='1062'>
<a name='1063'>
    FILE_TIMESTEP = TIMESTEP - FILE_FIRST_TIMESTEP<a name='1064'>
<a name='1065'>
    <font color=#447700>! Define write subset indices for variables:<a name='1066'></font>
<a name='1067'>
    STARTS( 1 ) = ISTART<a name='1068'>
    STARTS( 2 ) = JSTART<a name='1069'>
    STARTS( 3 ) = ZSTART<a name='1070'>
    STARTS( 4 ) = FILE_TIMESTEP + 1 <font color=#447700>! NetCDF follows FORTRAN 1-based convention.<a name='1071'></font>
    COUNTS( 1 ) = IM<a name='1072'>
    COUNTS( 2 ) = JM<a name='1073'>
    COUNTS( 3 ) = NSL<a name='1074'>
    COUNTS( 4 ) = 1<a name='1075'>
<a name='1076'>
    <font color=#447700>! Write each extra variable (if selected to be written):<a name='1077'></font>
<a name='1078'>
    REQUEST_COUNT = 0<a name='1079'>
<a name='1080'>
    VARIABLE = 1 <font color=#447700>! IRRADIANCE:<a name='1081'></font>
<a name='1082'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1083'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1084'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1085'>
                                  STARTS, COUNTS, &amp;<a name='1086'>
                                  IRRADIANCE( 1, 1, 1 ), &amp;<a name='1087'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1088'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_75">( ERR, 'write output variable  ' &amp;<a name='1089'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1090'>
    END IF<a name='1091'>
<a name='1092'>
    VARIABLE = 2 <font color=#447700>! IRRADIANCE_FRACTION:<a name='1093'></font>
<a name='1094'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1095'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1096'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1097'>
                                  STARTS, COUNTS, &amp;<a name='1098'>
                                  IRRADIANCE_FRACTION( 1, 1, 1 ), &amp;<a name='1099'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1100'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_76">( ERR, 'write output variable  ' &amp;<a name='1101'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1102'>
    END IF<a name='1103'>
<a name='1104'>
    DO INDEX = 1, SPECIES <font color=#447700>! UN(:,:,:,SPECIES):<a name='1105'></font>
      VARIABLE = VARIABLE + 1<a name='1106'>
<a name='1107'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1108'>
        REQUEST_COUNT = REQUEST_COUNT + 1<a name='1109'>
        ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1110'>
                                    STARTS, COUNTS, &amp;<a name='1111'>
                                    UN( 1, 1, 1, INDEX ), &amp;<a name='1112'>
                                    REQUESTS( REQUEST_COUNT ) )<a name='1113'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_77">( ERR, 'write output variable  ' &amp;<a name='1114'>
                     // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1115'>
      END IF<a name='1116'>
    END DO<a name='1117'>
<a name='1118'>
    DO INDEX = 1, SPECIES <font color=#447700>! UP(:,:,:,SPECIES):<a name='1119'></font>
      VARIABLE = VARIABLE + 1<a name='1120'>
<a name='1121'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1122'>
        REQUEST_COUNT = REQUEST_COUNT + 1<a name='1123'>
        ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1124'>
                                    STARTS, COUNTS, &amp;<a name='1125'>
                                    UP( 1, 1, 1, INDEX ), &amp;<a name='1126'>
                                    REQUESTS( REQUEST_COUNT ) )<a name='1127'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_78">( ERR, 'write output variable  ' &amp;<a name='1128'>
                     // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1129'>
      END IF<a name='1130'>
    END DO<a name='1131'>
<a name='1132'>
    DO INDEX = 1, SPECIES <font color=#447700>! UE(:,:,:,SPECIES):<a name='1133'></font>
      VARIABLE = VARIABLE + 1<a name='1134'>
<a name='1135'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1136'>
        REQUEST_COUNT = REQUEST_COUNT + 1<a name='1137'>
        ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1138'>
                                    STARTS, COUNTS, &amp;<a name='1139'>
                                    UE( 1, 1, 1, INDEX ), &amp;<a name='1140'>
                                    REQUESTS( REQUEST_COUNT ) )<a name='1141'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_79">( ERR, 'write output variable  ' &amp;<a name='1142'>
                     // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1143'>
      END IF<a name='1144'>
    END DO<a name='1145'>
<a name='1146'>
    DO INDEX = 1, SPECIES <font color=#447700>! UA(:,:,:,SPECIES):<a name='1147'></font>
      VARIABLE = VARIABLE + 1<a name='1148'>
<a name='1149'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1150'>
        REQUEST_COUNT = REQUEST_COUNT + 1<a name='1151'>
        ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1152'>
                                    STARTS, COUNTS, &amp;<a name='1153'>
                                    UA( 1, 1, 1, INDEX ), &amp;<a name='1154'>
                                    REQUESTS( REQUEST_COUNT ) )<a name='1155'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_80">( ERR, 'write output variable  ' &amp;<a name='1156'>
                     // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1157'>
      END IF<a name='1158'>
    END DO<a name='1159'>
<a name='1160'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! CHLA_MG_TOT:<a name='1161'></font>
<a name='1162'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1163'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1164'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1165'>
                                  STARTS, COUNTS, &amp;<a name='1166'>
                                  CHLA_MG_TOT( 1, 1, 1 ), &amp;<a name='1167'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1168'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_81">( ERR, 'write output variable  ' &amp;<a name='1169'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1170'>
    END IF<a name='1171'>
<a name='1172'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X1A:<a name='1173'></font>
<a name='1174'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1175'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1176'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1177'>
                                  STARTS, COUNTS, &amp;<a name='1178'>
                                  S_X1A( 1, 1, 1 ), &amp;<a name='1179'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1180'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_82">( ERR, 'write output variable  ' &amp;<a name='1181'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1182'>
    END IF<a name='1183'>
<a name='1184'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y1A:<a name='1185'></font>
<a name='1186'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1187'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1188'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1189'>
                                  STARTS, COUNTS, &amp;<a name='1190'>
                                  S_Y1A( 1, 1, 1 ), &amp;<a name='1191'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1192'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_83">( ERR, 'write output variable  ' &amp;<a name='1193'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1194'>
    END IF<a name='1195'>
<a name='1196'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X2A:<a name='1197'></font>
<a name='1198'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1199'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1200'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1201'>
                                  STARTS, COUNTS, &amp;<a name='1202'>
                                  S_X2A( 1, 1, 1 ), &amp;<a name='1203'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1204'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_84">( ERR, 'write output variable  ' &amp;<a name='1205'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1206'>
    END IF<a name='1207'>
<a name='1208'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y2A:<a name='1209'></font>
<a name='1210'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1211'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1212'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1213'>
                                  STARTS, COUNTS, &amp;<a name='1214'>
                                  S_Y2A( 1, 1, 1 ), &amp;<a name='1215'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1216'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_85">( ERR, 'write output variable  ' &amp;<a name='1217'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1218'>
    END IF<a name='1219'>
<a name='1220'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X1FP:<a name='1221'></font>
<a name='1222'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1223'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1224'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1225'>
                                  STARTS, COUNTS, &amp;<a name='1226'>
                                  S_X1FP( 1, 1, 1 ), &amp;<a name='1227'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1228'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_86">( ERR, 'write output variable  ' &amp;<a name='1229'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1230'>
    END IF<a name='1231'>
<a name='1232'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y1FP:<a name='1233'></font>
<a name='1234'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1235'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1236'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1237'>
                                  STARTS, COUNTS, &amp;<a name='1238'>
                                  S_Y1FP( 1, 1, 1 ), &amp;<a name='1239'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1240'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_87">( ERR, 'write output variable  ' &amp;<a name='1241'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1242'>
    END IF<a name='1243'>
<a name='1244'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X2FP:<a name='1245'></font>
<a name='1246'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1247'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1248'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1249'>
                                  STARTS, COUNTS, &amp;<a name='1250'>
                                  S_X2FP( 1, 1, 1 ), &amp;<a name='1251'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1252'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_88">( ERR, 'write output variable  ' &amp;<a name='1253'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1254'>
    END IF<a name='1255'>
<a name='1256'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y2FP:<a name='1257'></font>
<a name='1258'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1259'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1260'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1261'>
                                  STARTS, COUNTS, &amp;<a name='1262'>
                                  S_Y2FP( 1, 1, 1 ), &amp;<a name='1263'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1264'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_89">( ERR, 'write output variable  ' &amp;<a name='1265'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1266'>
    END IF<a name='1267'>
<a name='1268'>
    DO INDEX = 1, SPECIES <font color=#447700>! USI(:,:,:,SPECIES):<a name='1269'></font>
      VARIABLE = VARIABLE + 1<a name='1270'>
<a name='1271'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1272'>
        REQUEST_COUNT = REQUEST_COUNT + 1<a name='1273'>
        ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1274'>
                                    STARTS, COUNTS, &amp;<a name='1275'>
                                    USI( 1, 1, 1, INDEX ), &amp;<a name='1276'>
                                    REQUESTS( REQUEST_COUNT ) )<a name='1277'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_90">( ERR, 'write output variable  ' &amp;<a name='1278'>
                     // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1279'>
      END IF<a name='1280'>
    END DO<a name='1281'>
<a name='1282'>
    DO INDEX = 1, SPECIES <font color=#447700>! ChlC(:,:,:,SPECIES):<a name='1283'></font>
      VARIABLE = VARIABLE + 1<a name='1284'>
<a name='1285'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1286'>
        REQUEST_COUNT = REQUEST_COUNT + 1<a name='1287'>
        ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1288'>
                                    STARTS, COUNTS, &amp;<a name='1289'>
                                    ChlC( 1, 1, 1, INDEX ), &amp;<a name='1290'>
                                    REQUESTS( REQUEST_COUNT ) )<a name='1291'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_91">( ERR, 'write output variable  ' &amp;<a name='1292'>
                     // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1293'>
      END IF<a name='1294'>
    END DO<a name='1295'>
<a name='1296'>
<a name='1297'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! pH:<a name='1298'></font>
<a name='1299'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1300'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1301'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1302'>
                                  STARTS, COUNTS, &amp;<a name='1303'>
                                   pH( 1, 1, 1 ), &amp;<a name='1304'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1305'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_92">( ERR, 'write output variable  ' &amp;<a name='1306'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1307'>
    END IF<a name='1308'>
<a name='1309'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! RN2:<a name='1310'></font>
<a name='1311'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1312'>
      REQUEST_COUNT = REQUEST_COUNT + 1<a name='1313'>
      ERR = NFMPI_IPUT_VARA_REAL( FILE_ID, EXTRA_VAR( VARIABLE ), &amp;<a name='1314'>
                                  STARTS, COUNTS, &amp;<a name='1315'>
                                  RN2( 1, 1, 1 ), &amp;<a name='1316'>
                                  REQUESTS( REQUEST_COUNT ) )<a name='1317'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_93">( ERR, 'write output variable  ' &amp;<a name='1318'>
                   // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1319'>
    END IF<a name='1320'>
<a name='1321'>
<a name='1322'>
    ERR = NFMPI_WAIT_ALL( FILE_ID, REQUEST_COUNT, REQUESTS, STATUSES )<a name='1323'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_94">( ERR, 'inplement non-blocking interface' )<a name='1324'>
<a name='1325'>
    <font color=#447700>! Check status of each nonblocking call<a name='1326'></font>
<a name='1327'>
    DO REQUEST = 1, REQUEST_COUNT<a name='1328'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_95">( STATUSES( REQUEST ), 'nonblocking call ' )<a name='1329'>
    END DO<a name='1330'>
<a name='1331'>
    CALL <A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#FLUSH_FILE'>FLUSH_FILE</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#WRITE_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FLUSH_FILE_3">() <font color=#447700>! Flush buffers to disk in case of crash.<a name='1332'></font>
<a name='1333'>
    IF ( VARIABLE .NE. EXTRA_VARIABLES ) THEN<a name='1334'>
      PRINT *, 'PROBLEM: Mismatched EXTRA_VARIABLES count: ', EXTRA_VARIABLES<a name='1335'>
      STOP<a name='1336'>
    END IF<a name='1337'>
<a name='1338'>
    RETURN<a name='1339'>
  END SUBROUTINE WRITE_EXTRA_DATA<a name='1340'>
<a name='1341'>
<a name='1342'>
<a name='1343'>
  <font color=#447700>! READ_EXTRA_DATA: Read given timestep data from an existing file.<a name='1344'></font>
  <font color=#447700>! Called by concurrent programs to read a subset of data to restart.<a name='1345'></font>
  <font color=#447700>!<a name='1346'></font>
<A NAME='READ_EXTRA_DATA'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1347'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>READ_EXTRA_DATA</font>( NAME,                                         &amp; <A href='../../call_to/READ_EXTRA_DATA.html' TARGET='index'>2</A>,<A href='../../call_from/READ_EXTRA_DATA.html' TARGET='index'>40</A><a name='1348'>
                              ISTART, IM, JSTART, JM, ZSTART, NSL, SPECIES, &amp;<a name='1349'>
                              TIMESTEP, IRRADIANCE, IRRADIANCE_FRACTION,    &amp;<a name='1350'>
                              UN, UP, UE, UA, CHLA_MG_TOT,                  &amp;<a name='1351'>
                              S_X1A, S_Y1A, S_X2A, S_Y2A,                   &amp;<a name='1352'>
                              S_X1FP, S_Y1FP, S_X2FP, S_Y2FP, USI, ChlC, pH, RN2 )<a name='1353'>
    IMPLICIT NONE<a name='1354'>
    CHARACTER(LEN=*),INTENT(IN):: NAME<a name='1355'>
    INTEGER,INTENT(IN):: ISTART, JSTART, ZSTART<a name='1356'>
    INTEGER,INTENT(IN):: IM, JM, NSL, SPECIES, TIMESTEP <font color=#447700>! TIMESTEP is 1-based.<a name='1357'></font>
    REAL,DIMENSION(IM, JM, NSL):: IRRADIANCE<a name='1358'>
    REAL,DIMENSION(IM, JM, NSL):: IRRADIANCE_FRACTION<a name='1359'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UN<a name='1360'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UP<a name='1361'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UE<a name='1362'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: UA<a name='1363'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: USI<a name='1364'>
    REAL,DIMENSION(IM, JM, NSL, SPECIES):: ChlC <a name='1365'>
    REAL,DIMENSION(IM, JM, NSL):: CHLA_MG_TOT<a name='1366'>
    REAL,DIMENSION(IM, JM, NSL):: S_X1A, S_Y1A, S_X2A, S_Y2A<a name='1367'>
    REAL,DIMENSION(IM, JM, NSL):: S_X1FP, S_Y1FP, S_X2FP, S_Y2FP<a name='1368'>
    REAL,DIMENSION(IM, JM, NSL):: pH<a name='1369'>
    REAL,DIMENSION(IM, JM, NSL):: RN2<a name='1370'>
    <font color=#447700>! Locals:<a name='1371'></font>
    INTEGER(MPI_OFFSET_KIND):: STARTS( 4 ), COUNTS( 4 )<a name='1372'>
    INTEGER INFO, ERR, ID, VARIABLE_ID, VARIABLE, INDEX<a name='1373'>
<a name='1374'>
    <font color=#447700>! Open existing shared 64-bit NetCDF file for reading:<a name='1375'></font>
<a name='1376'>
    CALL MPI_INFO_CREATE( INFO, ERR )<a name='1377'>
    CALL MPI_INFO_SET( INFO, 'ind_rd_buffer_size', '16777216', ERR )<a name='1378'>
    ERR = NFMPI_OPEN( MPI_COMM_WORLD, trim(NAME), &amp;<a name='1379'>
                      IOR( NF_NOWRITE, NF_64BIT_OFFSET ), INFO, ID )<a name='1380'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_96">( ERR, 'open existing file ' // NAME )<a name='1381'>
    CALL MPI_INFO_FREE( INFO, ERR )<a name='1382'>
<a name='1383'>
    <font color=#447700>! Define read subset indices for variables:<a name='1384'></font>
<a name='1385'>
    STARTS( 1 ) = ISTART<a name='1386'>
    STARTS( 2 ) = JSTART<a name='1387'>
    STARTS( 3 ) = ZSTART<a name='1388'>
    STARTS( 4 ) = TIMESTEP<a name='1389'>
    COUNTS( 1 ) = IM<a name='1390'>
    COUNTS( 2 ) = JM<a name='1391'>
    COUNTS( 3 ) = NSL<a name='1392'>
    COUNTS( 4 ) = 1<a name='1393'>
<a name='1394'>
    <font color=#447700>! Read each extra variable (if written):<a name='1395'></font>
<a name='1396'>
    VARIABLE = 1 <font color=#447700>! IRRADIANCE:<a name='1397'></font>
<a name='1398'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1399'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1400'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_97">( ERR, 'inquire NetCDF variable ID ' )<a name='1401'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1402'>
                                 IRRADIANCE( 1, 1, 1 ) )<a name='1403'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_98">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1404'>
    END IF<a name='1405'>
<a name='1406'>
    VARIABLE = 2 <font color=#447700>! IRRADIANCE_FRACTION:<a name='1407'></font>
<a name='1408'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1409'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1410'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_99">( ERR, 'inquire NetCDF variable ID ' )<a name='1411'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1412'>
                                 IRRADIANCE_FRACTION( 1, 1, 1 ) )<a name='1413'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_100">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1414'>
    END IF<a name='1415'>
<a name='1416'>
    DO INDEX = 1, SPECIES <font color=#447700>! UN(:,:,:,SPECIES):<a name='1417'></font>
      VARIABLE = VARIABLE + 1<a name='1418'>
<a name='1419'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1420'>
        ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), &amp;<a name='1421'>
                               VARIABLE_ID )<a name='1422'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_101">( ERR, 'inquire NetCDF variable ID ' )<a name='1423'>
        ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1424'>
                                   UN( 1, 1, 1, INDEX ) )<a name='1425'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_102">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ))<a name='1426'>
      END IF<a name='1427'>
    END DO<a name='1428'>
<a name='1429'>
    DO INDEX = 1, SPECIES <font color=#447700>! UP(:,:,:,SPECIES):<a name='1430'></font>
      VARIABLE = VARIABLE + 1<a name='1431'>
<a name='1432'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1433'>
        ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), &amp;<a name='1434'>
                               VARIABLE_ID )<a name='1435'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_103">( ERR, 'inquire NetCDF variable ID ' )<a name='1436'>
        ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1437'>
                                   UP( 1, 1, 1, INDEX ) )<a name='1438'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_104">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ))<a name='1439'>
      END IF<a name='1440'>
    END DO<a name='1441'>
<a name='1442'>
    DO INDEX = 1, SPECIES <font color=#447700>! UE(:,:,:,SPECIES):<a name='1443'></font>
      VARIABLE = VARIABLE + 1<a name='1444'>
<a name='1445'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1446'>
        ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), &amp;<a name='1447'>
                               VARIABLE_ID )<a name='1448'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_105">( ERR, 'inquire NetCDF variable ID ' )<a name='1449'>
        ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1450'>
                                   UE( 1, 1, 1, INDEX ) )<a name='1451'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_106">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ))<a name='1452'>
      END IF<a name='1453'>
    END DO<a name='1454'>
<a name='1455'>
    DO INDEX = 1, SPECIES <font color=#447700>! UA(:,:,:,SPECIES):<a name='1456'></font>
      VARIABLE = VARIABLE + 1<a name='1457'>
<a name='1458'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1459'>
        ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), &amp;<a name='1460'>
                               VARIABLE_ID )<a name='1461'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_107">( ERR, 'inquire NetCDF variable ID ' )<a name='1462'>
        ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1463'>
                                   UA( 1, 1, 1, INDEX ) )<a name='1464'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_108">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ))<a name='1465'>
      END IF<a name='1466'>
    END DO<a name='1467'>
<a name='1468'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! CHLA_MG_TOT:<a name='1469'></font>
<a name='1470'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1471'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1472'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_109">( ERR, 'inquire NetCDF variable ID ' )<a name='1473'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1474'>
                                 CHLA_MG_TOT( 1, 1, 1 ) )<a name='1475'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_110">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1476'>
    END IF<a name='1477'>
<a name='1478'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X1A:<a name='1479'></font>
<a name='1480'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1481'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1482'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_111">( ERR, 'inquire NetCDF variable ID ' )<a name='1483'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1484'>
                                 S_X1A( 1, 1, 1 ) )<a name='1485'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_112">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1486'>
    END IF<a name='1487'>
<a name='1488'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y1A:<a name='1489'></font>
<a name='1490'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1491'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1492'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_113">( ERR, 'inquire NetCDF variable ID ' )<a name='1493'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1494'>
                                 S_Y1A( 1, 1, 1 ) )<a name='1495'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_114">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1496'>
    END IF<a name='1497'>
<a name='1498'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X2A:<a name='1499'></font>
<a name='1500'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1501'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1502'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_115">( ERR, 'inquire NetCDF variable ID ' )<a name='1503'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1504'>
                                 S_X2A( 1, 1, 1 ) )<a name='1505'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_116">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1506'>
    END IF<a name='1507'>
<a name='1508'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y2A:<a name='1509'></font>
<a name='1510'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1511'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1512'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_117">( ERR, 'inquire NetCDF variable ID ' )<a name='1513'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1514'>
                                 S_Y2A( 1, 1, 1 ) )<a name='1515'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_118">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1516'>
    END IF<a name='1517'>
<a name='1518'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X1FP:<a name='1519'></font>
<a name='1520'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1521'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1522'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_119">( ERR, 'inquire NetCDF variable ID ' )<a name='1523'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1524'>
                                 S_X1FP( 1, 1, 1 ) )<a name='1525'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_120">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1526'>
    END IF<a name='1527'>
<a name='1528'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y1FP:<a name='1529'></font>
<a name='1530'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1531'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1532'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_121">( ERR, 'inquire NetCDF variable ID ' )<a name='1533'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1534'>
                                 S_Y1FP( 1, 1, 1 ) )<a name='1535'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_122">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1536'>
    END IF<a name='1537'>
<a name='1538'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_X2FP:<a name='1539'></font>
<a name='1540'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1541'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1542'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_123">( ERR, 'inquire NetCDF variable ID ' )<a name='1543'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1544'>
                                 S_X2FP( 1, 1, 1 ) )<a name='1545'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_124">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1546'>
    END IF<a name='1547'>
<a name='1548'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! S_Y2FP:<a name='1549'></font>
<a name='1550'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1551'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1552'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_125">( ERR, 'inquire NetCDF variable ID ' )<a name='1553'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1554'>
                                 S_Y2FP( 1, 1, 1 ) )<a name='1555'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_126">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1556'>
    END IF<a name='1557'>
<a name='1558'>
    DO INDEX = 1, SPECIES <font color=#447700>! USI(:,:,:,SPECIES):<a name='1559'></font>
      VARIABLE = VARIABLE + 1<a name='1560'>
<a name='1561'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1562'>
        ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), &amp;<a name='1563'>
                               VARIABLE_ID )<a name='1564'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_127">( ERR, 'inquire NetCDF variable ID ' )<a name='1565'>
        ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1566'>
                                   USI( 1, 1, 1, INDEX ) )<a name='1567'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_128">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ))<a name='1568'>
      END IF<a name='1569'>
    END DO<a name='1570'>
<a name='1571'>
    DO INDEX = 1, SPECIES <font color=#447700>! ChlC(:,:,:,SPECIES):<a name='1572'></font>
      VARIABLE = VARIABLE + 1<a name='1573'>
<a name='1574'>
      IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1575'>
        ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), &amp;<a name='1576'>
                               VARIABLE_ID )<a name='1577'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_129">( ERR, 'inquire NetCDF variable ID ' )<a name='1578'>
        ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1579'>
                                   ChlC( 1, 1, 1, INDEX ) )<a name='1580'>
        CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_130">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ))<a name='1581'>
      END IF<a name='1582'>
    END DO<a name='1583'>
<a name='1584'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! pH:<a name='1585'></font>
<a name='1586'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1587'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1588'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_131">( ERR, 'inquire NetCDF variable ID ' )<a name='1589'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1590'>
                                 pH( 1, 1, 1 ) )<a name='1591'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_132">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1592'>
    END IF<a name='1593'>
<a name='1594'>
    VARIABLE = VARIABLE + 1 <font color=#447700>! RN2:<a name='1595'></font>
<a name='1596'>
    IF ( WRITE_EXTRA_VARIABLE( VARIABLE ) ) THEN<a name='1597'>
      ERR = NFMPI_INQ_VARID( ID, EXTRA_VARIABLE_NAMES( VARIABLE ), VARIABLE_ID)<a name='1598'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_133">( ERR, 'inquire NetCDF variable ID ' )<a name='1599'>
      ERR = NFMPI_GET_VARA_REAL_ALL( ID, VARIABLE_ID, STARTS, COUNTS, &amp;<a name='1600'>
                                 RN2( 1, 1, 1 ) )<a name='1601'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_134">( ERR, 'read variable ' // EXTRA_VARIABLE_NAMES( VARIABLE ) )<a name='1602'>
    END IF<a name='1603'>
<a name='1604'>
<a name='1605'>
    ERR = NFMPI_CLOSE( ID )<a name='1606'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#READ_EXTRA_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_135">( ERR, 'close NetCDF file ' )<a name='1607'>
<a name='1608'>
    IF ( VARIABLE .NE. EXTRA_VARIABLES ) THEN<a name='1609'>
      PRINT *, 'PROBLEM: Mismatched EXTRA_VARIABLES count: ', EXTRA_VARIABLES<a name='1610'>
      STOP<a name='1611'>
    END IF<a name='1612'>
<a name='1613'>
    RETURN<a name='1614'>
  END SUBROUTINE READ_EXTRA_DATA<a name='1615'>
<a name='1616'>
<a name='1617'>
<a name='1618'>
  <font color=#447700>! LAST_NETCDF_TIMESTEP: Return 1-based last timestep of named NetCDF file<a name='1619'></font>
  <font color=#447700>! and optionally verify input start/end time parameters match file attributes<a name='1620'></font>
  <font color=#447700>! and compute time parameters of the last timestep.<a name='1621'></font>
  <font color=#447700>!<a name='1622'></font>
<A NAME='LAST_NETCDF_TIMESTEP'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1623'>
  <font color=#993300>FUNCTION </font><font color=#cc0000>LAST_NETCDF_TIMESTEP</font>( NAME,                                    &amp; <A href='../../call_to/LAST_NETCDF_TIMESTEP.html' TARGET='index'>2</A>,<A href='../../call_from/LAST_NETCDF_TIMESTEP.html' TARGET='index'>25</A><a name='1624'>
                                 iYrS, iMonS, iDayS, iHrS, iMinS, iSecS,  &amp;<a name='1625'>
                                 iYrE, iMonE, iDayE, iHrE, iMinE, iSecE,  &amp;<a name='1626'>
                                 dT_out, CRASH_RESTART,                   &amp;<a name='1627'>
                                 LAST_TIMESTEP_SECONDS )                  &amp;<a name='1628'>
                                 RESULT( RES )<a name='1629'>
    IMPLICIT NONE<a name='1630'>
    CHARACTER(LEN=*),INTENT(IN):: NAME<a name='1631'>
    INTEGER,INTENT(IN):: iYrS, iMonS, iDayS, iHrS, iMinS, iSecS <font color=#447700>! Start time<a name='1632'></font>
    INTEGER,INTENT(IN):: iYrE, iMonE, iDayE, iHrE, iMinE, iSecE <font color=#447700>! End time<a name='1633'></font>
    INTEGER,INTENT(IN):: dT_out <font color=#447700>! Output timestep size in seconds.<a name='1634'></font>
    LOGICAL,INTENT(IN):: CRASH_RESTART <font color=#447700>! Crash restart or regular restart?<a name='1635'></font>
    INTEGER(8),INTENT(OUT):: LAST_TIMESTEP_SECONDS <font color=#447700>! Last written time variable<a name='1636'></font>
    INTEGER:: RES <font color=#447700>! 1-based NetCDF file last timestep.<a name='1637'></font>
    <font color=#447700>! Locals:<a name='1638'></font>
    INTEGER(MPI_OFFSET_KIND):: TIMESTEPS<a name='1639'>
    REAL(8):: SECONDS(1)<a name='1640'>
    INTEGER(MPI_OFFSET_KIND):: STARTS( 1 ), COUNTS( 1 )<a name='1641'>
    INTEGER INFO, ERR, ID, DIM_ID, TIMEVAR<a name='1642'>
<a name='1643'>
    RES = 0<a name='1644'>
<a name='1645'>
    <font color=#447700>! Open existing 64-bit NetCDF file for reading:<a name='1646'></font>
<a name='1647'>
    CALL MPI_INFO_CREATE( INFO, ERR )<a name='1648'>
    ERR = NFMPI_OPEN( MPI_COMM_WORLD, trim(NAME), &amp;<a name='1649'>
                      IOR( NF_NOWRITE, NF_64BIT_OFFSET ), INFO, ID )<a name='1650'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_136">( ERR, 'open existing file ' // NAME )<a name='1651'>
    CALL MPI_INFO_FREE( INFO, ERR )<a name='1652'>
<a name='1653'>
    <font color=#447700>! Verify input time parameters match file attributes:<a name='1654'></font>
<a name='1655'>
    IF ( CRASH_RESTART ) THEN <font color=#447700>! Start/end time parameters must match file:<a name='1656'></font>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_1">( ID, 'dT_out', dT_out )<a name='1657'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_2">( ID, 'iYrS',  iYrS  )<a name='1658'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_3">( ID, 'iMonS', iMonS )<a name='1659'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_4">( ID, 'iDayS', iDayS )<a name='1660'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_5">( ID, 'iHrS',  iHrS  )<a name='1661'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_6">( ID, 'iMinS', iMinS )<a name='1662'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_7">( ID, 'iSecS', iSecS )<a name='1663'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_8">( ID, 'iYrE',  iYrE  )<a name='1664'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_9">( ID, 'iMonE', iMonE )<a name='1665'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_10">( ID, 'iDayE', iDayE )<a name='1666'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_11">( ID, 'iHrE',  iHrE  )<a name='1667'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_12">( ID, 'iMinE', iMinE )<a name='1668'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_13">( ID, 'iSecE', iSecE )<a name='1669'>
    ELSE <font color=#447700>! Regular restart input start time must match end time of restart file<a name='1670'></font>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_14">( ID, 'iYrE',  iYrS  )<a name='1671'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_15">( ID, 'iMonE', iMonS )<a name='1672'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_16">( ID, 'iDayE', iDayS )<a name='1673'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_17">( ID, 'iHrE',  iHrS  )<a name='1674'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_18">( ID, 'iMinE', iMinS )<a name='1675'>
      CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHECKIAT'>CHECKIAT</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHECKIAT_19">( ID, 'iSecE', iSecS )<a name='1676'>
    END IF<a name='1677'>
<a name='1678'>
    <font color=#447700>! Get number of timesteps written to named NetCDF file:<a name='1679'></font>
<a name='1680'>
    ERR = NFMPI_INQ_UNLIMDIM( ID, DIM_ID )<a name='1681'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_137">( ERR, 'get unlimited dimension id in NetCDF file ' )<a name='1682'>
    ERR = NFMPI_INQ_DIMLEN( ID, DIM_ID, TIMESTEPS )<a name='1683'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_138">( ERR, 'get unlimited dimension length in NetCDF file ' )<a name='1684'>
<a name='1685'>
    <font color=#447700>! If crash restart, use next-to-last file timestep since the last file<a name='1686'></font>
    <font color=#447700>! timestep might be only partially written:<a name='1687'></font>
<a name='1688'>
    IF ( CRASH_RESTART ) THEN<a name='1689'>
      TIMESTEPS = TIMESTEPS - 1<a name='1690'>
<a name='1691'>
      IF ( TIMESTEPS .EQ. 0 ) THEN<a name='1692'>
        <font color=#447700>! Stop run if only one step is written in restart.nc.<a name='1693'></font>
        PRINT *, 'Restart NetCDF file has only 1 time step written, may be incomplete'<a name='1694'>
        STOP<a name='1695'>
      END IF<a name='1696'>
    END IF<a name='1697'>
<a name='1698'>
    RES = TIMESTEPS<a name='1699'>
<a name='1700'>
    <font color=#447700>! Get value of last successful written time variable<a name='1701'></font>
<a name='1702'>
    ERR = NFMPI_INQ_VARID( ID, 'time', TIMEVAR )<a name='1703'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_139">( ERR, 'inquire NetCDF variable ID ' )<a name='1704'>
<a name='1705'>
    STARTS(1) = TIMESTEPS<a name='1706'>
    COUNTS(1) = 1<a name='1707'>
<a name='1708'>
    ERR = NFMPI_GET_VARA_DOUBLE_ALL( ID, TIMEVAR, STARTS, COUNTS, SECONDS )<a name='1709'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_140">( ERR, 'read output variable time' )<a name='1710'>
<a name='1711'>
    ERR = NFMPI_CLOSE( ID )<a name='1712'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#LAST_NETCDF_TIMESTEP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_141">( ERR, 'close NetCDF file ' )<a name='1713'>
<a name='1714'>
    LAST_TIMESTEP_SECONDS = NINT( SECONDS(1), KIND=8 )<a name='1715'>
<a name='1716'>
    RETURN<a name='1717'>
  END FUNCTION LAST_NETCDF_TIMESTEP<a name='1718'>
<a name='1719'>
<a name='1720'>
<a name='1721'>
  <font color=#447700>! FLUSH_FILE: Flush buffers to disk in case of crash.<a name='1722'></font>
  <font color=#447700>!<a name='1723'></font>
<A NAME='FLUSH_FILE'><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#FLUSH_FILE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1724'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>FLUSH_FILE</font>() <A href='../../call_to/FLUSH_FILE.html' TARGET='index'>3</A>,<A href='../../call_from/FLUSH_FILE.html' TARGET='index'>1</A><a name='1725'>
    IMPLICIT NONE<a name='1726'>
    INTEGER ERR<a name='1727'>
<a name='1728'>
    ERR = NFMPI_SYNC( FILE_ID )<a name='1729'>
    CALL <A href='../../html_code/CGEM_2.0/NETCDF_UTILITIES.f.html#CHKERR'>CHKERR</A><A href='../../html_code/CGEM_2.0/OUTPUT_NETCDF.f.html#FLUSH_FILE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHKERR_142">( ERR, 'flush buffers to disk ' )<a name='1730'>
<a name='1731'>
    RETURN<a name='1732'>
  END SUBROUTINE FLUSH_FILE<a name='1733'>
<a name='1734'>
<a name='1735'>
  <font color=#447700>! Private<a name='1736'></font>
<a name='1737'>
<a name='1738'>
<a name='1739'>
END MODULE OUTPUT_NETCDF<a name='1740'>
<a name='1741'>
<a name='1742'>
</pre></body></html>
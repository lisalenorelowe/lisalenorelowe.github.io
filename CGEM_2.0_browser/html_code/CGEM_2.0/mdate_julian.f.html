<HTML> <BODY BGCOLOR=#eeeeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<A NAME='MDATE_JULIAN'><A href='../../html_code/CGEM_2.0/mdate_julian.f.html#MDATE_JULIAN' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2'>
      <font color=#993300>FUNCTION </font><font color=#cc0000>mdate_julian</font>(iMonTC,iDayTC,leapyr ) RESULT(jday) <A href='../../call_to/MDATE_JULIAN.html' TARGET='index'>3</A><a name='3'>
<a name='4'>
<font color=#447700>!--------------------------------------------------------------      <a name='5'></font>
<font color=#447700>!     Written by Barry Herchenroder/EMVL, April/May 2010 <a name='6'></font>
<font color=#447700>! <a name='7'></font>
<font color=#447700>!     Based in part on subroutine mdate written by D.S. Ko/NRL  <a name='8'></font>
<font color=#447700>!--------------------------------------------------------------<a name='9'></font>
<a name='10'>
<font color=#447700>!--------------------------------------------------------------<a name='11'></font>
<font color=#447700>!      mdate_julian returns the Julian day associated with the<a name='12'></font>
<font color=#447700>!      month iMonTC and day in month iDayTC of a particular year.<a name='13'></font>
<font color=#447700>!      Whether the year is a leap year (leapyr == .TRUE.) or<a name='14'></font>
<font color=#447700>!      not a leap year (leapyr == .FALSE.) is taken into account.<a name='15'></font>
<font color=#447700>!------------------------------------------------------------------  <a name='16'></font>
<a name='17'>
<font color=#447700>!---------------------------------------------------------<a name='18'></font>
<font color=#447700>! Declare variables coming through the function interface:<a name='19'></font>
<font color=#447700>!---------------------------------------------------------<a name='20'></font>
<a name='21'>
    INTEGER, INTENT(IN)    :: iMonTC<a name='22'>
    <a name='23'>
    INTEGER, INTENT(IN)    :: iDayTC <a name='24'>
    <a name='25'>
    LOGICAL, INTENT(IN)    :: leapyr <a name='26'>
    <a name='27'>
<font color=#447700>!---------------------------------------------------------<a name='28'></font>
<font color=#447700>! Declare other scalar variables<a name='29'></font>
<font color=#447700>!--------------------------------------------------------- <a name='30'></font>
<a name='31'>
       INTEGER  ::  jday  <a name='32'>
       <a name='33'>
<font color=#447700>!---------------------------------------------------------<a name='34'></font>
<font color=#447700>! Declare other array variables<a name='35'></font>
<font color=#447700>!--------------------------------------------------------- <a name='36'></font>
<font color=#447700>! Note: tht is a zero at the end of JM0.<a name='37'></font>
<a name='38'>
   integer  JM0(13,2) <font color=#447700>! Cumulative days in year at beginning of each<a name='39'></font>
                      <font color=#447700>! month. JMO(:,1) is for non-leap year and<a name='40'></font>
		      <font color=#447700>!        JMO(:,2) is for     leap year<a name='41'></font>
   <a name='42'>
   data  JM0/0,31,59,90,120,151,181,212,243,273,304,334,365,           &amp;<a name='43'>
     &amp;             0,31,60,91,121,152,182,213,244,274,305,335,366/<a name='44'>
   save  JM0<a name='45'>
<font color=#447700>!------------------------------------------------------------------------  <a name='46'></font>
<a name='47'>
<font color=#447700>!----------------<a name='48'></font>
<font color=#447700>! Begin main code<a name='49'></font>
<font color=#447700>!----------------<a name='50'></font>
<a name='51'>
<font color=#447700>! Branch depending upon whether leapyr is true or false. Note that it<a name='52'></font>
<font color=#447700>! is assumed that 12:00 midnight is associated with the beginning of<a name='53'></font>
<font color=#447700>! the following day, not the end of the preceeding day. So if <a name='54'></font>
<a name='55'>
      IF(leapyr == .FALSE.) THEN<a name='56'>
         <font color=#447700>! The year is not a leap year<a name='57'></font>
           jday = JM0(iMonTC,1) + iDayTC<a name='58'>
      <a name='59'>
      ELSE<a name='60'>
         <font color=#447700>! The year is a leap year<a name='61'></font>
           jday = JM0(iMonTC,2) + iDayTC           <a name='62'>
      ENDIF<a name='63'>
<a name='64'>
      END FUNCTION mdate_julian<a name='65'>
<font color=#447700>!-----------------------------------------------------------------------------<a name='66'></font>
</pre></body></html>
<HTML> <BODY BGCOLOR=#eeeeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!&gt; \file rhoinsitu.f90<a name='2'></font>
<font color=#447700>!! \BRIEF <a name='3'></font>
<font color=#447700>!&gt; Module with rhoinsitu subroutine - compute in situ density from S, Tis, P<a name='4'></font>
<A NAME='MRHOINSITU'><A href='../../html_code/CGEM_2.0/rhoinsitu.f.html#MRHOINSITU' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='5'>
<font color=#993300>MODULE </font><font color=#cc0000>mrhoinsitu</font> <A href='../../call_to/MRHOINSITU.html' TARGET='index'>5</A><a name='6'>
CONTAINS<a name='7'>
<font color=#447700>!&gt;     Compute in situ density from salinity (psu), in situ temperature (C), &amp; pressure (db).<a name='8'></font>
<font color=#447700>!!     This subroutine is needed because rho is a function (using scalars not arrays)<a name='9'></font>
<A NAME='RHOINSITU'><A href='../../html_code/CGEM_2.0/rhoinsitu.f.html#RHOINSITU' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='10'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>rhoinsitu</font>(salt, tempis, pdbar, N, rhois) <A href='../../call_to/RHOINSITU.html' TARGET='index'>5</A>,<A href='../../call_from/RHOINSITU.html' TARGET='index'>3</A><a name='11'>
<a name='12'>
  <font color=#447700>!     Purpose:<a name='13'></font>
  <font color=#447700>!     Compute in situ density from salinity (psu), in situ temperature (C), &amp; pressure (db)<a name='14'></font>
  <font color=#447700>!     Needed because rho is a function<a name='15'></font>
<a name='16'>
  USE <A href='../../html_code/CGEM_2.0/singledouble.f.html#MSINGLEDOUBLE'>msingledouble</A><A href='../../html_code/CGEM_2.0/rhoinsitu.f.html#RHOINSITU' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MSINGLEDOUBLE_19"><a name='17'>
  USE <A href='../../html_code/CGEM_2.0/rho.f.html#MRHO'>mrho</A><A href='../../html_code/CGEM_2.0/rhoinsitu.f.html#RHOINSITU' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MRHO_1"><a name='18'>
  IMPLICIT NONE<a name='19'>
<a name='20'>
  INTEGER :: N<a name='21'>
<a name='22'>
<font color=#447700>! INPUT variables<a name='23'></font>
  <font color=#447700>! salt   = salinity [psu]<a name='24'></font>
  <font color=#447700>! tempis = in situ temperature [C]<a name='25'></font>
  <font color=#447700>! pdbar  = pressure [db]<a name='26'></font>
<a name='27'>
  <font color=#447700>!&gt; salinity [psu]<a name='28'></font>
  REAL(kind=r4), INTENT(in), DIMENSION(N) :: salt<a name='29'>
  <font color=#447700>!&gt; in situ temperature [C]<a name='30'></font>
  REAL(kind=r4), INTENT(in), DIMENSION(N) :: tempis<a name='31'>
  <font color=#447700>!&gt; pressure [db]<a name='32'></font>
  REAL(kind=r4), INTENT(in), DIMENSION(N) :: pdbar<a name='33'>
<font color=#447700>!f2py optional , depend(salt) :: n=len(salt)<a name='34'></font>
<a name='35'>
<font color=#447700>! OUTPUT variables:<a name='36'></font>
  <font color=#447700>! rhois  = in situ density<a name='37'></font>
<a name='38'>
  <font color=#447700>!&gt; in situ density [kg/m3]<a name='39'></font>
  REAL(kind=r4), INTENT(out), DIMENSION(N) :: rhois<a name='40'>
<a name='41'>
<font color=#447700>! Local variables<a name='42'></font>
  INTEGER :: i<a name='43'>
<a name='44'>
<font color=#447700>! REAL(kind=r4) ::  rho<a name='45'></font>
<font color=#447700>! EXTERNAL rho<a name='46'></font>
<a name='47'>
  DO i = 1,N<a name='48'>
     rhois(i) = <A href='../../html_code/CGEM_2.0/rho.f.html#RHO'>rho</A><A href='../../html_code/CGEM_2.0/rhoinsitu.f.html#RHOINSITU' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RHO_1">(salt(i), tempis(i), pdbar(i)/10.)<a name='49'>
  END DO<a name='50'>
<a name='51'>
  RETURN<a name='52'>
END SUBROUTINE rhoinsitu<a name='53'>
END MODULE mrhoinsitu<a name='54'>
</pre></body></html>